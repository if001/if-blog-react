{"componentChunkName":"component---src-pages-index-js","path":"/","webpackCompilationHash":"01eaf5e6ec7e5dd6e10a","result":{"data":{"site":{"siteMetadata":{"title":"アンドロイドは推理小説を書くか?","author":"いふ","labels":[{"tag":"react","tech":"React","name":"DiReact","size":17,"color":"black"},{"tag":"nodejs","tech":"Node.js","name":"DiNodejsSmall","size":17,"color":"green"},{"tag":"git","tech":"Git","name":"DiGit","size":17,"color":"black"},{"tag":"javascript","tech":"JavaScript","name":"DiJsBadge","size":17,"color":"black"},{"tag":"css","tech":"CSS","name":"DiCss3Full","size":17,"color":"teal"},{"tag":"python","tech":"Python","name":"DiPython","size":17,"color":"deepskyblue"},{"tag":"ruby","tech":"Ruby","name":"DiRuby","size":17,"color":"crimson"},{"tag":"java","tech":"Java","name":"FaJava","size":17,"color":"red"},{"tag":"angular","tech":"Angular","name":"DiAngularSimple","size":17,"color":"red"},{"tag":"html","tech":"HTML","name":"FaHtml5","size":17,"color":"darkorange"},{"tag":"php","tech":"php","name":"DiPhp","size":17,"color":"violet"},{"tag":"mongodb","tech":"MongoDB","name":"DiMongodb","size":17,"color":"green"},{"tag":"vscode","tech":"VS Code","name":"DiVisualstudio","size":17,"color":"deepskyblue"},{"tag":"go","tech":"go","name":"DiGo","size":17,"color":"black"},{"tag":"golang","tech":"Golang","name":"DiGo","size":17,"color":"black"},{"tag":"読書","tech":"読書","name":"FaBookOpen","size":17,"color":"blue"},{"tag":"読了","tech":"読了","name":"FaBook","size":17,"color":"green"},{"tag":"hugo","tech":"Hugo","name":"FaServer","size":17,"color":"pink"},{"tag":"docker","tech":"Docker","name":"DiDocker","size":17,"color":"blue"},{"tag":"aws","tech":"Aws","name":"DiAws","size":17,"color":"orange"},{"tag":"nlp","tech":"NLP","name":"FaLanguage","size":17,"color":"black"},{"tag":"firebase","tech":"FireBase","name":"DiGoogleCloudPlatform","size":17,"color":"blue"},{"tag":"deeplearning","tech":"DeepLearning","name":"FaBrain","size":17,"color":"blue"},{"tag":"poem","tech":"poem","name":"FaPenFancy","size":17,"color":"yellow"},{"tag":"rust","tech":"rust","name":"DiRust","size":17,"color":"black"},{"tag":"tex","tech":"tex","name":"FaTextHeight","size":17,"color":"teal"}]}},"allMarkdownRemark":{"totalCount":31,"edges":[{"node":{"excerpt":"Firebase Authenticationに続いて、Firebase Hostingも使ってみました。備忘録を残しておきます。 今回は、Vue.jsをデプロイします。 Firebase Hostingとは Firebase Hosting は、ウェブアプリ、静的コンテンツと動的コンテンツ、マイクロサービス向けの高速で安全性の高いホスティングを提供します。 Firebase Hosting…","html":"<p>Firebase Authenticationに続いて、Firebase Hostingも使ってみました。備忘録を残しておきます。<br>\n今回は、Vue.jsをデプロイします。</p>\n<h2 id=\"firebase-hostingとは\"><a href=\"#firebase-hosting%E3%81%A8%E3%81%AF\" aria-label=\"firebase hostingとは permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Firebase Hostingとは</h2>\n<blockquote>\n<p>Firebase Hosting は、ウェブアプリ、静的コンテンツと動的コンテンツ、マイクロサービス向けの高速で安全性の高いホスティングを提供します。</p>\n</blockquote>\n<blockquote>\n<p>Firebase Hosting はデベロッパー向けの、本番環境レベルのウェブ コンテンツ ホスティングです。1 つのコマンドですばやくウェブアプリをデプロイすることができ、静的コンテンツと動的コンテンツの両方をグローバル CDN（コンテンツ配信ネットワーク）に配信できます。Firebase Hosting と Cloud Functions または Cloud Run を併用してマイクロサービスを構築し、Firebase にホスティングすることもできます。</p>\n</blockquote>\n<p>引用： <a href=\"https://firebase.google.com/docs/hosting?hl=ja\">https://firebase.google.com/docs/hosting?hl=ja</a></p>\n<p>無料で手軽にアプリケーションを公開するにはすごく便利という印象。  </p>\n<p>Firebaseでは、転送量を超えない限り、複数アプリケーションをデプロイできるので、本番環境だけでなく、テスト環境もほしいという場合には有効かと思います。Herokuの無料枠では起動している時間の制限などで実質１アプリケーションしか動かせませんでした。</p>\n<p>また、Hostingで利用できる無料のストレージが１GBですが、ブログなどのようにどんどんコンテンツが増えていくサイトでなければ十分な量だと思います。画像などがある場合は、Firebase Storageなどを利用する手もあるかと思います。</p>\n<p>参考<br>\n<a href=\"https://firebase.google.com/pricing/?hl=ja\">Firebaseの料金体系</a>  </p>\n<p><a href=\"https://medium.com/google-cloud-jp/%E9%9D%99%E7%9A%84%E3%82%B5%E3%82%A4%E3%83%88%E3%83%9B%E3%82%B9%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E7%82%BA%E3%81%AEgcs-gae-firebase-hosting%E6%AF%94%E8%BC%83-e7d406609f2e\">静的サイトホスティングの為のGCS/GAE/Firebase Hosting比較</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQ4y82Uy0rDQBSGE4v1hkK1C8UruGitaJWidSFFK67VneDGnUuXgiA+hS/gSnpJmzSZZJI0k+ZSqpZSqgiK6Kt40rrQtthYEIR/MXPgm3POP2eGotJC9/ormK6rG9jBUjyI/i1MA5bMjXIYBAtn6xZOCX0MiiiFqGqsKUZYLvQzCIKu4F4G7RB7SlAnBTUokQWJbGkWBF3AKd7H4ahiUDfsnlk6tO9WsR7G+hgnU63Ft8LQ56KoRWT9ovpwXCoPZyXg4URX8FBWjBN7RlAh8zLWBzLirl4czIodYLgVT533c/KmZs06PWvbxPbXa+5hWq69Ke2nEhyd5OdFbVpQqUQOtk4wyTcn/7qZ4JWARMCboEgg2wiLl7AOnockMs4rcyjvY3EbuDFPAShSs6DD03IV2r56embf3i+rj9cvr/tm6bxSixPLmZm2mUOYxDQLssWIta4aR8X7s0oNDD+5rWzkzQOztCIXvlXeNB7eDALPPAyC43tADIK1l0HgtjctgPN0N0+y8UJ+MOzffAYd9QF0kEMCIaB/ewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"logo\"\n        title=\"logo\"\n        src=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png\"\n        srcset=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c0399/logo.png 100w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/9ec3c/logo.png 200w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png 400w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/34e8a/logo.png 600w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/8ff1e/logo.png 800w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png 1200w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Firebase Hostingを使って公開したアプリはこちら  </p>\n<p><a href=\"https://www.if-blog.site/posts/edgwbs/book_reports_review/\">三行で読書感想文を書いて、SNSでシェアできるサービスを作った</a>  </p>\n<h2 id=\"準備\"><a href=\"#%E6%BA%96%E5%82%99\" aria-label=\"準備 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>準備</h2>\n<p>デプロイ用のコマンドラインツールをインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g firebase-tools</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>以下のコマンドで、firebaseにログインします。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ firebase login</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>プロジェクトで、初めてfirebaseを使う場合には、以下のコマンドでfirebaseを初期化します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ firebase init</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>初期化すると、<code class=\"language-text\">firebase.json</code>が作成されます。Hostingやstorage、functionsなどのその他のfirebaseの設定を記述します。基本的にはここで生成された<code class=\"language-text\">firebase.json</code>を書き換えることなく利用できます。</p>\n<h2 id=\"デプロイ\"><a href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\" aria-label=\"デプロイ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>デプロイ</h2>\n<p>生成された<code class=\"language-text\">firebase.json</code>にデプロイ用のディレクトリは、<code class=\"language-text\">public</code>と設定されているので、publicにアプリをビルドします。\nVue.jsのプロジェクトの場合は、以下のようにビルド。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ npm run build</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><code class=\"language-text\">public</code>以下に生成された成果物は、以下のコマンドでfirebaseにデプロイすることができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ firebase deploy</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"複数サイトをデプロイする\"><a href=\"#%E8%A4%87%E6%95%B0%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%99%E3%82%8B\" aria-label=\"複数サイトをデプロイする permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>複数サイトをデプロイする</h2>\n<p>本番環境とテスト環境がほしい場合などには、複数サイトをデプロイしたです。<br>\n(別のアプリをデプロイする場合は、プロジェクト変えるよね？普通？本番/テスト以外にどう使うんだろう??)   </p>\n<p><code class=\"language-text\">firebase.json</code>のhostingの項目を以下のように書き換えます。  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"hosting\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"env\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 自分で定義した、一意なアプリの識別子</span>\n      <span class=\"token property\">\"public\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"app/public\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"prod\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 自分で定義した、一意なアプリの識別子</span>\n      <span class=\"token property\">\"public\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"app/public\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>次に以下のコマンドで、<code class=\"language-text\">target</code>名とプロジェクトのサイト名を対応付けます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\"># $ firebase target:apply hosting target-name resource-name</span>\n\n$ firebase target:apply hosting <span class=\"token function\">env</span> myapp-blog\n$ firebase target:apply hosting prod myapp-blog</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>あとは、以下のコマンドでデプロイします。  </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\"># $ firebase deploy --only hosting:target-name</span>\n\n$ firebase deploy --only hosting:env\n$ firebase deploy --only hosting:prod</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"ドメインを設定\"><a href=\"#%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%82%92%E8%A8%AD%E5%AE%9A\" aria-label=\"ドメインを設定 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ドメインを設定</h2>\n<p>Hostingのサイトの管理、「ドメインを接続」からドメインが設定できます。<br>\n手順どおりで簡単に行なえます。<br>\n証明書が入るまでに少し時間がかかったので気長に待ちましょう。  </p>\n<p>ちなみに、CNAMEでいけるかと思ったけど無理でした。  </p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Firebase Hostingを使って、アプリケーションのデプロイを行いました。<br>\nデプロイは驚くほど簡単でした。ローカルで動いているアプリケーションをそのまま、デプロイできるのが良かったです。  </p>","id":"68509870-8eed-575d-84bb-a02db8e06a92","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#firebase-hosting%E3%81%A8%E3%81%AF\">Firebase Hostingとは</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#%E6%BA%96%E5%82%99\">準備</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\">デプロイ</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#%E8%A4%87%E6%95%B0%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%81%99%E3%82%8B\">複数サイトをデプロイする</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%82%92%E8%A8%AD%E5%AE%9A\">ドメインを設定</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_hosting/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"Firebase Hostingを使ってみた","date":"2019-10-09","tags":["firebase","WebApp"]},"fields":{"slug":"/edgwbs/book_reports_hosting/"}}},{"node":{"excerpt":"Vue.jsで作ったWebAppをFirebase Hostingで公開し、そこでTwitter用のOGPを設定しようとしましたが、Twitterのクローラーがjavascriptを解釈できないということで、別途方法を考える必要がありました。そこで、Firebase Cloud Functionsを使ってtwitter：OGPを設定してみようと思います。 Firebase Cloud…","html":"<p>Vue.jsで作ったWebAppをFirebase Hostingで公開し、そこでTwitter用のOGPを設定しようとしましたが、Twitterのクローラーがjavascriptを解釈できないということで、別途方法を考える必要がありました。そこで、Firebase Cloud Functionsを使ってtwitter：OGPを設定してみようと思います。</p>\n<p>Firebase Cloud Functionsとは</p>\n<blockquote>\n<p>Cloud Functions for Firebase を使用すると、Firebase 機能や HTTPS リクエストによってトリガーされたイベントに応じて、バックエンド コードを自動的に実行できます。コードは Google のクラウドに保存され、マネージド環境で実行されます。独自のサーバーを管理およびスケーリングする必要はありません。</p>\n</blockquote>\n<p>引用： <a href=\"https://firebase.google.com/docs/functions/?hl=ja\">https://firebase.google.com/docs/functions/?hl=ja</a></p>\n<p>今回は、HTTPSリクエストをトリガーに使いましたが、FirebaseのDatabaseへの書き込みやGitHubのpush/commitなどもトリガーにできるようです。色々と便利に使えそうです。</p>\n<p>Cloud Functions で可能な処理:<br>\n<a href=\"https://firebase.google.com/docs/functions/use-cases?hl=ja\">https://firebase.google.com/docs/functions/use-cases?hl=ja</a></p>\n<p>Firebase Cloud Functionsで使える言語は、今のところNode.js(javascript)だけのようです。Google CLoud Functionsでは、Node.js(javascript)、python、（Golang）がサポートされているので今後このあたりの言語もサポートされるのではないでしょうか。\nFirebase Cloud Functions用に、javascriptのライブラリが提供されており、どうしても別の言語で書きたいという場合でなければ、不便なく使えるかと思います。</p>\n<p>作ったアプリはこれ。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQ4y82Uy0rDQBSGE4v1hkK1C8UruGitaJWidSFFK67VneDGnUuXgiA+hS/gSnpJmzSZZJI0k+ZSqpZSqgiK6Kt40rrQtthYEIR/MXPgm3POP2eGotJC9/ormK6rG9jBUjyI/i1MA5bMjXIYBAtn6xZOCX0MiiiFqGqsKUZYLvQzCIKu4F4G7RB7SlAnBTUokQWJbGkWBF3AKd7H4ahiUDfsnlk6tO9WsR7G+hgnU63Ft8LQ56KoRWT9ovpwXCoPZyXg4URX8FBWjBN7RlAh8zLWBzLirl4czIodYLgVT533c/KmZs06PWvbxPbXa+5hWq69Ke2nEhyd5OdFbVpQqUQOtk4wyTcn/7qZ4JWARMCboEgg2wiLl7AOnockMs4rcyjvY3EbuDFPAShSs6DD03IV2r56embf3i+rj9cvr/tm6bxSixPLmZm2mUOYxDQLssWIta4aR8X7s0oNDD+5rWzkzQOztCIXvlXeNB7eDALPPAyC43tADIK1l0HgtjctgPN0N0+y8UJ+MOzffAYd9QF0kEMCIaB/ewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"logo\"\n        title=\"logo\"\n        src=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png\"\n        srcset=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c0399/logo.png 100w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/9ec3c/logo.png 200w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png 400w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/34e8a/logo.png 600w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/8ff1e/logo.png 800w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png 1200w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://bookreports.edgwbs.net\">三行読書感想文</a></p>\n<h2 id=\"ogp設定\"><a href=\"#ogp%E8%A8%AD%E5%AE%9A\" aria-label=\"ogp設定 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OGP設定</h2>\n<p>今回は、ページによって設定したいOGPが異なるため、ページごとに動的に設定する必要があります。<br>\nページごとに異なる情報は、Firebase CloudStoreに保存してあるので、そこから取得します。  </p>\n<p>また、ツイッターのクローラーからのリクエストならばOGP用のページを返却し、通常のアクセスならばページを表示するというような振り分けも行います。</p>\n<p>リクエストが来てからのフローは以下の用になります</p>\n<ul>\n<li>リクエストの振り分け</li>\n<li>DBからデータの取得</li>\n<li>リダイレクト or OGP設定</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/f570d/vuejs_golang_firebase_functions.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABNklEQVQoz52RTU7DMBCFcyJ2nIuDcAWW7JEqFmyphFgHtait2tLihMaJazu1E9v1H1NAaZCQWvE0sizbb/zNTBJjDH8pHnXYe0UDefIxSCnbtnXOwWEST8szE+P2ORtc5JtstVrPZjOMsbU2gTQZQsVHzhmlO10SCheUUjBZF6Ty89UG5SWnaJw+pC+vxuimaeB/733indtJRWrN2rhf39M8LQmvqqqGZLu9spExCsFrIaThnIGnQzpgK6VxWREq1fJ2Ph4q7eqaFxhXuHDWHumDc97325FA6dPpBMjzPFN6368V2BhjS9Bi0bQNKTAlVf9BApmgdFiBJ/SQOgkhgMIa84wmN3eD4dvoe0Anut3NTButRTPaosvrq8f38VcJ4cxRdeMOqUDG218NO9v8E/8xd7SdPgHHWXt5UK524AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vuejs_golang_firebase_functions\"\n        title=\"vuejs_golang_firebase_functions\"\n        src=\"/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/c7805/vuejs_golang_firebase_functions.png\"\n        srcset=\"/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/c0399/vuejs_golang_firebase_functions.png 100w,\n/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/9ec3c/vuejs_golang_firebase_functions.png 200w,\n/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/c7805/vuejs_golang_firebase_functions.png 400w,\n/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/34e8a/vuejs_golang_firebase_functions.png 600w,\n/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/8ff1e/vuejs_golang_firebase_functions.png 800w,\n/if-blog-react/static/10c0354f1ccfa8a182f61b8e3690790b/f570d/vuejs_golang_firebase_functions.png 960w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"シンプルなリスポンス例\"><a href=\"#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AA%E3%83%AA%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E4%BE%8B\" aria-label=\"シンプルなリスポンス例 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>シンプルなリスポンス例</h2>\n<p>200を返すシンプルなfunctionsの例は以下</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> functions <span class=\"token keyword\">from</span> <span class=\"token string\">'firebase-functions'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> share <span class=\"token operator\">=</span> functions<span class=\"token punctuation\">.</span>https<span class=\"token punctuation\">.</span><span class=\"token function\">onRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello world\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"リクエストの振り分け\"><a href=\"#%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%81%AE%E6%8C%AF%E3%82%8A%E5%88%86%E3%81%91\" aria-label=\"リクエストの振り分け permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>リクエストの振り分け</h2>\n<p>Twitterのクローラーは、User-Agentが<code class=\"language-text\">User-agent: Twitterbot</code>なので、これを使います。<br>\nUAがTwitterbotの場合はOGPを設定し返却、それ以外の場合は通常のページへリダイレクトさせるようにします。  </p>\n<p>UAは以下の用に取得できます。 </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ua <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user-agent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ua:'</span><span class=\"token punctuation\">,</span>ua<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>リクエストを振り分けるために、エンドポイントを<code class=\"language-text\">firebase.json</code>を修正します。<br>\n<code class=\"language-text\">/for_twitter</code>にアクセスが来るとFunctionsが呼ばれ、それ以外は通常のページを返します。  </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-json line-numbers\"><code class=\"language-json\">  <span class=\"token property\">\"rewrites\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t    <span class=\"token property\">\"source\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/for_twitter/*\"</span><span class=\"token punctuation\">,</span>\n\t\t    <span class=\"token property\">\"function\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"for_twitter\"</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t    <span class=\"token property\">\"source\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"**\"</span><span class=\"token punctuation\">,</span>\n\t\t    <span class=\"token property\">\"destination\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/index.html\"</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"cloud-storeからデータを取得\"><a href=\"#cloud-store%E3%81%8B%E3%82%89%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97\" aria-label=\"cloud storeからデータを取得 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Storeからデータを取得</h2>\n<p>Firebase Admin SDKを使うと、FunctionsからDB/Storageに対し管理者としてアクセスが可能になります。もちろんですが、サーバー側空だけでフロント側から使わないように注意です。</p>\n<p>サーバーに Firebase Admin SDK を追加する:<br>\n<a href=\"https://firebase.google.com/docs/admin/setup?hl=ja\">https://firebase.google.com/docs/admin/setup?hl=ja</a>  </p>\n<p>環境変数にsevice accountを追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">GOOGLE_APPLICATION_CREDENTIALS</span><span class=\"token operator\">=</span><span class=\"token string\">\"/home/user/Downloads/service-account-file.json\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>以下のようにSKDの初期化を行います。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> admin <span class=\"token keyword\">from</span> <span class=\"token string\">'firebase-admin'</span><span class=\"token punctuation\">;</span>\n\nadmin<span class=\"token punctuation\">.</span><span class=\"token function\">initializeApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  credential<span class=\"token punctuation\">:</span> admin<span class=\"token punctuation\">.</span>credential<span class=\"token punctuation\">.</span><span class=\"token function\">applicationDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  databaseURL<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://&lt;DATABASE_NAME>.firebaseio.com'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>あとは、adminを使って、firestoreへアクセス可能です。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> admin<span class=\"token punctuation\">.</span><span class=\"token function\">firestore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collection</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nref<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">snapshot</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// ...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>データの取得などはドキュメント参考<br>\n<a href=\"https://firebase.google.com/docs/firestore?hl=ja\">https://firebase.google.com/docs/firestore?hl=ja</a></p>\n<h2 id=\"twiter-ogpの設定\"><a href=\"#twiter-ogp%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-label=\"twiter ogpの設定 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Twiter OGPの設定</h2>\n<p>以下の４つが設定できるようです。  </p>\n<ul>\n<li>Summary Card</li>\n<li>Summary Card with Large Image</li>\n<li>App Card</li>\n<li>Player Card</li>\n</ul>\n<p>Optimize Tweets with Cards<br>\n<a href=\"https://developer.twitter.com/en/docs/tweets/optimize-with-cards/overview/abouts-cards\">https://developer.twitter.com/en/docs/tweets/optimize-with-cards/overview/abouts-cards</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/98829/twitter_card.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQoz62SW04DMQxFi9gP24APdoHYFEJCFAXxwwdLYAlIbKCIohY6z0wmmTj2xelDlYbHVy3duc44OmPZM6GUJocIQPYHZrmAyCOEbwBMd2LBlBJPmceStRLLrdaNwk4yR0SOdvT7FyU8L4C2+MKqrFGVBZZtQMLfIfv0fAs83gJx9eaB14/afy4WNHuf02pVUN001LSWnHPkvaeu68iFSG5I1PoYuyHFDFXQ6Rh4nT8zmy+jtR2qqoK1FgpAURQoyxJN06oalJ1H5aL6IApeN8kiZz86zAXbex9CIH1Q9r73pEsjLf2qHEPMKUYdipj8NjDWM1NDxCb/b4b4a4aaXIaYnnQud7UbjLrJXvfRNKq8Sb1jeCxmkxI/KHC/ZT0c6D/ccL4BTFjgC3KUo9QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"twitter_card\"\n        title=\"twitter_card\"\n        src=\"/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/c7805/twitter_card.png\"\n        srcset=\"/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/c0399/twitter_card.png 100w,\n/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/9ec3c/twitter_card.png 200w,\n/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/c7805/twitter_card.png 400w,\n/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/34e8a/twitter_card.png 600w,\n/if-blog-react/static/7a1017895c3f39069beba4cf7df12bb5/98829/twitter_card.png 693w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/e98ad/twitter_card_large.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.88530465949822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD+0lEQVQ4y5WV708cRRjH+RuM/0gTtUWuWOjVa6MCjaAvbIzRaEyUFoTGxBe+8ZWJNGrTN/rOAh7HUaCNNiXlV2uaEKVVavl1J/SE9u64293Zmd29427n+frsQlIgJOAk35lnd2Y/892ZfWZrqpqeB+m3AGoDsEO6reLrNv8AVVmkdSuPf7uq9ZkaBtUzAPeKQN71UZICWYdb/L+iwprWAmCdKGt8PlPVv61a/srygp5fK2pXQ/OIQ4mrqlENgcs1BESINHK5HJmmSQZLmAaZxQKZlkV5u0xFocgoFqnICsZsbBQom82RYRhhnM/n/QCniVLsEBGf55hfXMLf8wu0uJzCUiqNh/OLSK8+RjqzjqX0Ct9L4dHCAlYfZ/Dn3EM8zeZQKm9CKgVbKR36I0pvAwl54WFDeFSwPZgqiN1tObCdYEVpj3aVEKh1CKRIiQ1/ea+ET8YdujgpcX7KQ8eEg+4Jie5JhS5W56SDrmkvVPe0i4tTLrrHbXxx10X7bVePrIQetxxaZSA6pHC016RI3MYL/Q5iSYFTCYGX+ywc7zPDtjauUD8gURd30BgXaOgt4NSgRG2/1F/P0jOg2ARaRiQaBwS9es3BK4MK53618emEjdeSFk4nTLx7U+DDMRtnRyVOM6QlaXCfwJlBG3V9Qvfc93cDm4ZtnIgLOjnk4ERC4f1bNj67o/DxbYH3fjHQMSVZPMm4hbbhIoMEogM84ZBEbEjpy3N7HL4xotAQNymalKhPOOzIRicDz0/auMCg9gA4LfHBmOSlsNB83UETPxNjt8f6bN3zQO8EUgg8zg5jgyYaedCbowLtE4Jfm9sphQ6Gd0wrvD4s0cDrGI2b7FCEwNp+xcA9DptHecETik4mA5iFj8YEOtlZ1x3e3bsKF9hd6w2FaNJFjB0GiiZsxBh6rFfoSzuBVpnQyJ1Hrgp6sV/ipWAXkwpNPEnrDYnmEZt318ZR7qv7mXW1gHduSpy7pdByXeLIT0J/NRPm3hbQ4/jHvzx8O+vSd/dL+GZGoud3Dz1/eLjECu59z7ryoITLsx6uzDoYSpVxLV3GyD9l/DBX0uPr299hpVKNBKE08lhdekS5tVVkUosoPMkgk15E7t+Vwxw2Yab4Qab4vh8CDctGZv0pPcnmkc0XYAkbuY0CHM8LEy1IT05++NvSu7Qj9bgKgZWqHyQ7lTcrYbyzcNIfpGdAvo4ENx3HpVKpRJ7nkXKcUK7rEp8mxG9BW9z9C/f72yZSDKQ6Pr5Iepvadjd9bn3Fst1yqODaKVf5tCc/eHY/aa35TxLOuFzDdfgLCDadT37IClDSW7GqbrWuf7jfAAPXA4fPcdjM1weKN6CZ9lcT95/lNvofTdICC/4GZpEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"twitter_card_large\"\n        title=\"twitter_card_large\"\n        src=\"/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/c7805/twitter_card_large.png\"\n        srcset=\"/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/c0399/twitter_card_large.png 100w,\n/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/9ec3c/twitter_card_large.png 200w,\n/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/c7805/twitter_card_large.png 400w,\n/if-blog-react/static/bd0465fc9df5b4c7434930cc4e31ae28/e98ad/twitter_card_large.png 558w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>今回はSummary Card with Large Imageを使います。ヘッダーに以下を追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>twitter:card<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>summary_large_image<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>meta</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>og:image<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>imageURL<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>UAがTwitterbotの場合は、以下の関数を利用し、headerを設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">buildHtmlWithPost</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">id<span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">,</span> siteUrl<span class=\"token punctuation\">:</span>string<span class=\"token punctuation\">,</span> imageURL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> string <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!DOCTYPE html>&lt;head>\n  &lt;title>&lt;/title>\n  &lt;meta name=\"twitter:card\" content=\"summary_large_image\"/>\n  &lt;meta name=\"twitter:title\" property=\"og:title\" content=\"タイトル\"/>\n  &lt;meta property=\"og:url\" content=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>siteURL<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">\n  &lt;meta property=\"og:image\" content=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageURL<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">\n  &lt;meta property=\"og:image:width\" content=\"600\"> \n  &lt;/head>\n  &lt;body>&lt;/body>\n  &lt;/html></span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>正しく設定できているかは以下から確認できます。</p>\n<p><a href=\"https://cards-dev.twitter.com/validator\">https://cards-dev.twitter.com/validator</a></p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Firebase Cloud Functionsを使って、Twitter用のOGPを設定しました。<br>\nHTTPSリクエストをトリガーにし、Firebase Storageから情報を取得、headerを付与し返却するという使い方でしたが、簡単に使うことができました。他のFirebaseのサービスへのアクセスは簡単なので、Firebaseを利用したいろいろなアプリケーションが簡単に作れそうです。他のトリガーなども使ってみたいと思います。</p>","id":"5199ccaa-3fc8-578d-8a34-a7767652eac4","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#ogp%E8%A8%AD%E5%AE%9A\">OGP設定</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AA%E3%83%AA%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E4%BE%8B\">シンプルなリスポンス例</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%81%AE%E6%8C%AF%E3%82%8A%E5%88%86%E3%81%91\">リクエストの振り分け</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#cloud-store%E3%81%8B%E3%82%89%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E5%8F%96%E5%BE%97\">Cloud Storeからデータを取得</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#twiter-ogp%E3%81%AE%E8%A8%AD%E5%AE%9A\">Twiter OGPの設定</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_cloud_functions/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"Firebase Cloud Functionsを使ってTwitterのOGPを設定する","date":"2019-09-29","tags":["firebase","WebApp"]},"fields":{"slug":"/edgwbs/book_reports_cloud_functions/"}}},{"node":{"excerpt":"Vue.jsとGolangでWebアプリケーションでFirebase Authenticationを使い、ログイン処理を行います。 https://firebase.google.com/docs/auth/?hl=ja    Firebaseの説明や導入などは、Qiitaにもわかりやすい記事がたくさん上がっているので、そちらを参考にしてください。  Vue.js側 VueCLI…","html":"<p>Vue.jsとGolangでWebアプリケーションでFirebase Authenticationを使い、ログイン処理を行います。<br>\n<a href=\"https://firebase.google.com/docs/auth/?hl=ja\">https://firebase.google.com/docs/auth/?hl=ja</a>  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/f570d/vuejs_golang_firebase.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAA60lEQVQoz6VSyw7BQBTtp9n5CN9gYSmx9wXY65aFnQ0riUjEI2mQoItKPfoYrUyrmLnVh1a1UU2c3LmZnMmZe+6dYew/wCQYcNeW1cWResaKIiOEMMa/xeDB2RjL+nTYkVV9s1lzHCcIQsbKEQMRULBpgnyLqQ0HDVmG5eQHEN9I8lJKSMgzoWEnVwftfLFU7jZjpdGdjHRjcrnONVybLYYnxfMCH2IeSzm2MpZ4/ywU8+atsVPZ/bkva4XptiXKDklCcdAnrPDh5nmO9f8AcIPS3lEVsOmTMfEr0of3ddoUIP1jkOA5054qC56i23/E892KyAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vuejs_golang_firebase\"\n        title=\"vuejs_golang_firebase\"\n        src=\"/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/c7805/vuejs_golang_firebase.png\"\n        srcset=\"/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/c0399/vuejs_golang_firebase.png 100w,\n/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/9ec3c/vuejs_golang_firebase.png 200w,\n/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/c7805/vuejs_golang_firebase.png 400w,\n/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/34e8a/vuejs_golang_firebase.png 600w,\n/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/8ff1e/vuejs_golang_firebase.png 800w,\n/if-blog-react/static/d155b97ff546f21ae4875f7273dc51b0/f570d/vuejs_golang_firebase.png 960w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Firebaseの説明や導入などは、Qiitaにもわかりやすい記事がたくさん上がっているので、そちらを参考にしてください。 </p>\n<h2 id=\"vuejs側\"><a href=\"#vuejs%E5%81%B4\" aria-label=\"vuejs側 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vue.js側</h2>\n<p>VueCLI3を使い、typescriptのプロジェクトを作成します。今回は、vueのrouter guardは省略します。</p>\n<h3 id=\"準備\"><a href=\"#%E6%BA%96%E5%82%99\" aria-label=\"準備 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>準備</h3>\n<p>npmからインストールします。 </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> firebase</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>firebaseの認証情報は、以下のドキュメントを参考に取得しておきます。<br>\n<a href=\"https://firebase.google.com/docs/auth/web/password-auth?authuser=1\">https://firebase.google.com/docs/auth/web/password-auth?authuser=1</a></p>\n<p><code class=\"language-text\">src/main.ts</code>にfirebaseをimportし、上記で取得した認証情報を貼り付けます。 </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> firebase <span class=\"token keyword\">from</span> <span class=\"token string\">'firebase/app'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> fireBaseConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  apiKey<span class=\"token punctuation\">:</span> <span class=\"token string\">'*****'</span><span class=\"token punctuation\">,</span>\n  authDomain<span class=\"token punctuation\">:</span> <span class=\"token string\">'*****.firebaseapp.com'</span><span class=\"token punctuation\">,</span>\n  databaseURL<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://******.firebaseio.com'</span><span class=\"token punctuation\">,</span>\n  projectId<span class=\"token punctuation\">:</span> <span class=\"token string\">'*****'</span><span class=\"token punctuation\">,</span>\n  storageBucket<span class=\"token punctuation\">:</span> <span class=\"token string\">'*****.appspot.com'</span><span class=\"token punctuation\">,</span>\n  messagingSenderId<span class=\"token punctuation\">:</span> <span class=\"token string\">'******'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nfirebase<span class=\"token punctuation\">.</span><span class=\"token function\">initializeApp</span><span class=\"token punctuation\">(</span>fireBaseConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"ログイン処理\"><a href=\"#%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86\" aria-label=\"ログイン処理 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ログイン処理</h3>\n<p>firebaseではemail+passwordの通常の認証に加え、GoogleアカウントやTwitter、Githubのアカウントでのログインが1つのメソッドだけで行えます。 </p>\n<p>Googleなどのアカウントでログインしたい場合は、あらかじめfirebaseから認証を許可するよう設定しておく必要があります。 </p>\n<h4 id=\"signin-with-emailpassword\"><a href=\"#signin-with-emailpassword\" aria-label=\"signin with emailpassword permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>signIn with email+password</h4>\n<p>コンポーネントにfirebaseのログイン画面を作ります。以下はその例です。 </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Component<span class=\"token punctuation\">,</span> Vue<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vue-property-decorator'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> firebase <span class=\"token keyword\">from</span> <span class=\"token string\">'firebase/app'</span><span class=\"token punctuation\">;</span>\n\n@Component\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Home</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Vue</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> email<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> password<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> showPassword<span class=\"token punctuation\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">siginInWithEmail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">signInWithEmailAndPassword</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res<span class=\"token punctuation\">:</span> firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>UserCredential</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>user <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user not found'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n              <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span><span class=\"token function\">getIdToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">idToken<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">finally</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>見て分かる通り、以下のメソッドの引数にメールアドレスとパスワードを渡すだけです。<br>\n<code class=\"language-text\">firebase.auth().signInWithEmailAndPassword(this.email, this.password)</code></p>\n<p>このメソッドは、<code class=\"language-text\">Promise&lt;firebase.auth.UserCredential&gt;</code>を返します。 User情報などはここから取得できます。 </p>\n<p>UserCredentialの中身は以下のドキュメントを参考。<br>\n<a href=\"https://firebase.google.com/docs/reference/js/firebase.auth.html#usercredential\">https://firebase.google.com/docs/reference/js/firebase.auth.html#usercredential</a></p>\n<p><code class=\"language-text\">firebase.auth.UserCredential</code>のもつ<code class=\"language-text\">user</code>が<code class=\"language-text\">getIdToken</code>メソッドを持っており、ここからトークンが取得できます。 </p>\n<p>PWAやスマホアプリでは、リフレッシュトークンを使いたいです。<code class=\"language-text\">getIdToken</code>では、トークンが失効していれば、firebase側でリフレッシュトークンを使ったトークンの更新処理を行ってくれるため、わざわざトークンの更新処理を追加する必要がありません。 </p>\n<p><a href=\"https://firebase.google.com/docs/reference/js/firebase.User.html#getidtoken\">https://firebase.google.com/docs/reference/js/firebase.User.html#getidtoken</a></p>\n<h4 id=\"signin-with-googlepopup\"><a href=\"#signin-with-googlepopup\" aria-label=\"signin with googlepopup permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>signIn with Google(popup)</h4>\n<p>ログイン方法には、Popupで別ウィンドウが開きログインを行う方法とリダイレクトを用いた方法があります。 Googleアカウントを使いpopupでログインしたい場合は、以下のようにします。 </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\">  <span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Component<span class=\"token punctuation\">,</span> Vue<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vue-property-decorator'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">import</span> firebase <span class=\"token keyword\">from</span> <span class=\"token string\">'firebase/app'</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">private</span> provider <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>GoogleAuthProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  @Component\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Home</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Vue</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token function\">signInByGoogleWithPopup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        firebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">signInWithPopup</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res<span class=\"token punctuation\">:</span> firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>UserCredential</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token comment\">// 省略</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>providerにGoogleを指定し、<code class=\"language-text\">firebase.auth().signInWithPopup(this.provider)</code>を呼ぶと、popupで見慣れたログイン画面が表示されます。\n図</p>\n<p><code class=\"language-text\">firebase.auth().signInWithPopup(this.provider)</code>もEmail+Passwordの場合と同様に、<code class=\"language-text\">Promise&lt;firebase.auth.UserCredential&gt;</code>を返すので、同様の方法でtokenやuser情報を取得できます。 </p>\n<h4 id=\"signin-with-googleredirect\"><a href=\"#signin-with-googleredirect\" aria-label=\"signin with googleredirect permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>signIn with Google(redirect)</h4>\n<p>PWAでは、リダイレクトでのログインが推奨されています。 </p>\n<p>リダイレクトは以下のようにします。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\">  <span class=\"token keyword\">private</span> <span class=\"token function\">siginInByGoogleWithRedirect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">signInWithRedirect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">finally</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">siginInByGoogleWithRedirect</code>が呼ばれるとログイン画面にリダイレクトされます。</p>\n<p>ログイン画面から元のページへ遷移後、リダイレクトによる認証が正しく行えたか確認します。 </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\"> <span class=\"token keyword\">private</span> <span class=\"token function\">afterRedirect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getRedirectResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res<span class=\"token punctuation\">:</span> firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>UserCredential</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\">// 省略</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">getRedirectResult</code>が<code class=\"language-text\">firebase.auth.UserCredential</code>を返すので、正しく認証できていれば、ここから先ほどと同様にユーザー情報やトークンを取得できます。 </p>\n<h4 id=\"github-or-twitter\"><a href=\"#github-or-twitter\" aria-label=\"github or twitter permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>github or twitter</h4>\n<p>Googleアカウントを使った場合と同様に、プロバイダを指定しログインできます。\n予めTwitterでデベロッパーアプリケーションとしてアプリを登録し、APIキーとAPI Secretを取得しておきます。\nTwitterデベロッパー側に、OAuthコールバックとして、firebaseのURLを指定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\">provider <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>GithubAuthProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or </span>\nprovider <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">firebase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>TwitterAuthProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfirebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">signInWithPopup</span><span class=\"token punctuation\">(</span>provider<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><a href=\"https://firebase.google.com/docs/auth/web/github-auth?hl=ja\">https://firebase.google.com/docs/auth/web/github-auth?hl=ja</a>\n<a href=\"https://firebase.google.com/docs/auth/web/twitter-login?hl=ja\">https://firebase.google.com/docs/auth/web/twitter-login?hl=ja</a></p>\n<h3 id=\"パスワードの再設定\"><a href=\"#%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC%E3%83%89%E3%81%AE%E5%86%8D%E8%A8%AD%E5%AE%9A\" aria-label=\"パスワードの再設定 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>パスワードの再設定</h3>\n<p>パスワードの再設定のメールを送信するのも、メソッド1つで行えます。 </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-typescript line-numbers\"><code class=\"language-typescript\">firebase<span class=\"token punctuation\">.</span><span class=\"token function\">auth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendPasswordResetEmail</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>送信されるメールのbodyは、firebaseから設定が行えます。 </p>\n<p>ユーザーの更新、削除も同様に行えます。\n詳しくはドキュメントを参考。 </p>\n<p><a href=\"https://firebase.google.com/docs/auth/web/manage-users?hl=ja#top_of_page\">https://firebase.google.com/docs/auth/web/manage-users?hl=ja#top_of_page</a></p>\n<h3 id=\"メールアドレスの重複\"><a href=\"#%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%81%AE%E9%87%8D%E8%A4%87\" aria-label=\"メールアドレスの重複 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>メールアドレスの重複</h3>\n<p>Firebase Authenticationでは、メールアドレスの重複はデフォルトでは許可されていません。 Email+Passwordでアカウントを作成し、同じメールアドレスのGoogleアカウントでログインしようとすると、Googleアカウント側が有効となります。 このとき、ユーザー識別子は、Email+Passwordで作成したものが、Googleアカウントで作成したものに移行されるようです。 </p>\n<p>重複を許可する設定も行えますが、1つのユーザーに複数のプロバイダを紐づけることもできるので、そちらを行った方が良いかと思います。\n<a href=\"https://firebase.google.com/docs/auth/web/account-linking\">https://firebase.google.com/docs/auth/web/account-linking</a></p>\n<h3 id=\"認証状態の永続性\"><a href=\"#%E8%AA%8D%E8%A8%BC%E7%8A%B6%E6%85%8B%E3%81%AE%E6%B0%B8%E7%B6%9A%E6%80%A7\" aria-label=\"認証状態の永続性 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>認証状態の永続性</h3>\n<p><a href=\"https://firebase.google.com/docs/auth/web/auth-state-persistence?hl=ja\">https://firebase.google.com/docs/auth/web/auth-state-persistence?hl=ja</a></p>\n<h2 id=\"golang側\"><a href=\"#golang%E5%81%B4\" aria-label=\"golang側 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Golang側</h2>\n<p>フロントで取得したJWTを、バックエンドに投げ、バックエンドからJWTが正しいかをfirebaeに問い合わせに行きます。<br>\nユーザーのログインのフローは簡単に書くと以下の図のような流れになります。  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/f570d/vuejs_golang_firebase_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABPUlEQVQoz41QW07DMBDMvTgWvxwACXEAvjgBHAH1EyEhhBAqqG0apU0c24kTO3FI/GTloApKVXU+rNXszux6Iuec1hreOsB7/1ok9w+zN5wYpVGBkiRJ05RVTBtjvO+N/bJuw0Vc86jve4wx5zyO48VyObTyhazPrs/fq01b8xwhQghjjFBqjVn04822vMPN1Wd6OU8isBuGAV6llA/Q1sxlbsNF4LtarUA8tZRzVJvO2EcmZrSJ/F+M4wheshEIoXDmD4QQbdt2UrKqBNOJ3Bc3TVOWJSaECw4LoaaUQiLwr6qqgIdbwMZ5b/+Ld8AFjGEpJYQCYmAgTrDuug6umJgD4qmhlJ6KHQkukMtv8uDm0BYf/Olikxd5nmdZBhFAHHtzh8VhdbZ+vt3mpK5ZHACbTxGfiiNi+J11R8XffCR5mJSkxBMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vuejs_golang_firebase_2\"\n        title=\"vuejs_golang_firebase_2\"\n        src=\"/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/c7805/vuejs_golang_firebase_2.png\"\n        srcset=\"/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/c0399/vuejs_golang_firebase_2.png 100w,\n/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/9ec3c/vuejs_golang_firebase_2.png 200w,\n/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/c7805/vuejs_golang_firebase_2.png 400w,\n/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/34e8a/vuejs_golang_firebase_2.png 600w,\n/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/8ff1e/vuejs_golang_firebase_2.png 800w,\n/if-blog-react/static/56ecb54bfaf7632a9717d5833db837d5/f570d/vuejs_golang_firebase_2.png 960w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>コード例は、以下の用になります。  </p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">ctx <span class=\"token operator\">:=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> opt option<span class=\"token punctuation\">.</span>ClientOption\n\n<span class=\"token comment\">// localのjson keyから認証する場合</span>\nopt <span class=\"token operator\">=</span> option<span class=\"token punctuation\">.</span><span class=\"token function\">WithCredentialsFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"****.json\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 環境変数から認証する場合</span>\ncredentials<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">CredentialsFromJSON</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span>authKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t os<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\nopt <span class=\"token operator\">=</span> option<span class=\"token punctuation\">.</span><span class=\"token function\">WithCredentials</span><span class=\"token punctuation\">(</span>credentials<span class=\"token punctuation\">)</span>\n\t\t\n\napp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> firebase<span class=\"token punctuation\">.</span><span class=\"token function\">NewApp</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> opt<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t os<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nclient<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">Auth</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error getting Auth client: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n\t os<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ヘッダーからIDトークンを取得</span>\nauthHeader <span class=\"token operator\">:=</span> c<span class=\"token punctuation\">.</span><span class=\"token function\">GetHeader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nidToken <span class=\"token operator\">:=</span> strings<span class=\"token punctuation\">.</span><span class=\"token function\">Replace</span><span class=\"token punctuation\">(</span>authHeader<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Bearer \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// トークンを確認</span>\ntoken<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">VerifyIDToken</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">Background</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> idToken<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">Fatalf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error verifying ID token: %v\\n\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nlog<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Verified ID token: %v\\n\"</span><span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>参考\n<a href=\"https://firebase.google.com/docs/auth/admin/verify-id-tokens?hl=ja\">https://firebase.google.com/docs/auth/admin/verify-id-tokens?hl=ja</a></p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Vue.jsとGolangからFirebase Authenticationを使いユーザーの管理を行いました。\nこれまで、ユーザー管理用のAPIを自分で書いていましたが、バックエンドもフロントエンドも少しコードを書くだけで認証が行えるfirebase、めっちゃ楽、すばらしいです. </p>\n<p>一方、firebaseは認証トークンにJWT(json web token)を使っており、JWTは使うべきでないというような記事も割と見かけるので、この辺りはもう少し詳しく調べて見ようかと思います。 </p>","id":"59d052c1-b2ad-55f7-b5ee-3443ab39021b","tableOfContents":"<ul>\n<li>\n<p><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#vuejs%E5%81%B4\">Vue.js側</a></p>\n<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E6%BA%96%E5%82%99\">準備</a></li>\n<li>\n<p><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86\">ログイン処理</a></p>\n<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#signin-with-emailpassword\">signIn with email+password</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#signin-with-googlepopup\">signIn with Google(popup)</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#signin-with-googleredirect\">signIn with Google(redirect)</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#github-or-twitter\">github or twitter</a></li>\n</ul>\n</li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC%E3%83%89%E3%81%AE%E5%86%8D%E8%A8%AD%E5%AE%9A\">パスワードの再設定</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%81%AE%E9%87%8D%E8%A4%87\">メールアドレスの重複</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E8%AA%8D%E8%A8%BC%E7%8A%B6%E6%85%8B%E3%81%AE%E6%B0%B8%E7%B6%9A%E6%80%A7\">認証状態の永続性</a></li>\n</ul>\n</li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#golang%E5%81%B4\">Golang側</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_firebase/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"Vue.js + Golang + Firebase Authenticationでログイン処理","date":"2019-09-27","tags":["WebApp","firebase","golang"]},"fields":{"slug":"/edgwbs/book_reports_firebase/"}}},{"node":{"excerpt":"サービス概要 「読書感想文をもっと気軽に」をコンセプトに読んだ本の感想文/レビューを三行だけ書き、SNSでシェアするサービスです。  三行読書感想文 使い方 googleアカウントもしくは、Twitterアカウントでログインできます。 その他のSNS…","html":"<h2 id=\"サービス概要\"><a href=\"#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E6%A6%82%E8%A6%81\" aria-label=\"サービス概要 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>サービス概要</h2>\n<p>「読書感想文をもっと気軽に」をコンセプトに読んだ本の感想文/レビューを三行だけ書き、SNSでシェアするサービスです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQ4y82Uy0rDQBSGE4v1hkK1C8UruGitaJWidSFFK67VneDGnUuXgiA+hS/gSnpJmzSZZJI0k+ZSqpZSqgiK6Kt40rrQtthYEIR/MXPgm3POP2eGotJC9/ormK6rG9jBUjyI/i1MA5bMjXIYBAtn6xZOCX0MiiiFqGqsKUZYLvQzCIKu4F4G7RB7SlAnBTUokQWJbGkWBF3AKd7H4ahiUDfsnlk6tO9WsR7G+hgnU63Ft8LQ56KoRWT9ovpwXCoPZyXg4URX8FBWjBN7RlAh8zLWBzLirl4czIodYLgVT533c/KmZs06PWvbxPbXa+5hWq69Ke2nEhyd5OdFbVpQqUQOtk4wyTcn/7qZ4JWARMCboEgg2wiLl7AOnockMs4rcyjvY3EbuDFPAShSs6DD03IV2r56embf3i+rj9cvr/tm6bxSixPLmZm2mUOYxDQLssWIta4aR8X7s0oNDD+5rWzkzQOztCIXvlXeNB7eDALPPAyC43tADIK1l0HgtjctgPN0N0+y8UJ+MOzffAYd9QF0kEMCIaB/ewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"logo\"\n        title=\"logo\"\n        src=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png\"\n        srcset=\"/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c0399/logo.png 100w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/9ec3c/logo.png 200w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/c7805/logo.png 400w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/34e8a/logo.png 600w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/8ff1e/logo.png 800w,\n/if-blog-react/static/48fe82c772514dfc1b1a6d6713f9f4ce/6ff5e/logo.png 1200w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://bookreports.edgwbs.net\">三行読書感想文</a></p>\n<h2 id=\"使い方\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-label=\"使い方 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h2>\n<p>googleアカウントもしくは、Twitterアカウントでログインできます。<br>\nその他のSNSアカウントでのログインは、随時対応していこうと思います。  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/702f6/login.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.26027397260275%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAB7ElEQVQ4y5VUTU/bQBTMj+WCOORQVCQ49A9URbQClEN+AdzgDyChCgloIBDR2FZiGufbdmwndpZchp0lG20paZzDaON9s/PeznubQrfbxWg0QhiGS+H7PobDIYIgWMqhRq/XQ4Hk6XSKNE2RZZmC/i2EwGAwgGVZqFarYHLuaZ7Jpwa1CszMzclksgAJ4/EYURQhSRLEcbyogt+MmXyCGh8KUoyHGo0G6vW6Wj3Pg+M4Cq7rot1uK15uQVbAasyVYCJyknmFpuiHgpqQyu9ICulGELw+Rekpkyy483VphTroei1c39/hrvaI6u8nPDk2nD/PqDw+4FnG2IRcV9ZZWRW986Rf7U4HHQmOxVAe4pVzefgXSR7KjFHSMJPmbooGfaNfQfjmYSTHhz7q2VvpoQ6ym5y7mlWXsFCzLdhuU3nYbLWUcO4uU4ydpF/duXfkkExfuU9vmTD32Oi54zUp0O/3VRIeYELztawcG9PD9w3R3pnIN9j6tcgKY1kN11A2R7/l9yO2lmA0kmJBqAQD/kFE8T/c/wqmXOnPbAZxeACxXYT4sgux9xkvxU2Io+8qlubxcNEUiZnI8PXkF7YOL7FTvsKn0k9s7F/g22lFxcbrXJkQWYozO8bxrY9yxUfppo8f1z7O7UTFlnn4Cj8Nm+qBZG7fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"login\"\n        title=\"login\"\n        src=\"/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/c7805/login.png\"\n        srcset=\"/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/c0399/login.png 100w,\n/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/9ec3c/login.png 200w,\n/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/c7805/login.png 400w,\n/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/34e8a/login.png 600w,\n/if-blog-react/static/693a0edb6e03d34154007d20fb0638b8/702f6/login.png 657w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>ログイン後に、感想を書く本を選びます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/67148/select_book.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.87179487179487%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAA70lEQVQoz52PO7KCQBBF2a1aauRm1GdgKQauCTSlAIH5MmbX7oHxKWpCcGoGbt9DEy3iHVbnPebxHyaHNaaHjT8ndPJ9etxgFm8xO279vcvDzP/84rTDkoiuaYqmrnG3LZyxcLbHdMimwS0vIKoaRiq0xnzMcZeza3pBlCQJairZll7SsCZMj5ASDWVVVeFG8F0I8TbDWBJLpZDQcp2QNuSXXkIFSSKlNXRPKIZnRWUmZF5InfRV2PYbcqBfZEPBkCDk/KuQwyH8Ed78W/ZTGMIxfPwyf90557ccA3f595/CLMtQliWKohgFd/M898IH+9eWVeNSVnwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"select_book\"\n        title=\"select_book\"\n        src=\"/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/c7805/select_book.png\"\n        srcset=\"/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/c0399/select_book.png 100w,\n/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/9ec3c/select_book.png 200w,\n/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/c7805/select_book.png 400w,\n/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/34e8a/select_book.png 600w,\n/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/8ff1e/select_book.png 800w,\n/if-blog-react/static/3d94bde0392358881fb2f87723c26fc9/67148/select_book.png 1248w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>あとは、感想を書き、保存します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/f5ece/write_reports.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.50734312416556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQ4y3WTy2vUUBTG88+4swVxpW5cuHEh/g8iiOBK0BZcKLRVFAsFQUQQF658gGBbF1KtRdHqTMEidN7SmclMkslMJpk8b16f516T6bS2B36ck5t7v3z33BvpzOIdnHp4G+cfP8C5R/cwfXcGU/M3MbUwS/Xsv3r+hmCaOD6XQeP8/fTCDE6TxtmleZy8fwvSm41PeL3xETxzXq6vYeXnN6xsfsHbr+tYLf7ASrGI5WIB7woFfPi1JVgtbOLV5zViby3XkeTdJvbYhdLuQG3/wYul63gyd43qFpwIMF1AHoQIWQIRcSLm71/fhFStVjFJuVqD3pPxdPEqLl88gdLvLfQNA72eCtMaoj8YwA8CjGwbFZpfmVjLa6lWqyGnXq/RYA221cezxSu4dOEYWo0Smi0ZjUYDmtZDpyNDlmWMRiOaX8/W1ccaEn8Yk71UFBnF78tYe/+c3HbQbsvY2dlBuVzG9vY2SqUShsPhPsGc/YJEtVKFaVtwwWAjgBu4UFUVuq6LrGmawLIsHFwrBHOr4z5UKlC6XRjUtwH1q9/vo5s9m6YpnHExLnqw/2LLfGJATfZ9X2RRez48zxP4ROCTU9cV8LE85/M5jDHxIcmm5tp0YrbnIkGagQOkyCNN92oeSZKMx7gpySJBPfLQCx2Bxmxogf1fVok4TeA6Djl0hBB3yk+bu+PBXUs63a1B7CENI1imhSSOcVgMQtpyzBDHKRjNjaKI6hhhGIp6LNgnQSP24doOFFVBkH0toW3k5IJ+EqPbM6Eb1qEf9YVD08CQBJnrw6BTTaIjHDJ+kRK0mi206F7yYFGCkByH9BtSguO4kEx7BCVyoDNH9KrHOM4EtnjX9k0E5NANEthBDIeyI/K/2nQZ/aImbZnumevTFWEBImp6SIsmibLMD+ToSMc9/AuD2Ir97+4duAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"write_reports\"\n        title=\"write_reports\"\n        src=\"/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/c7805/write_reports.png\"\n        srcset=\"/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/c0399/write_reports.png 100w,\n/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/9ec3c/write_reports.png 200w,\n/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/c7805/write_reports.png 400w,\n/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/34e8a/write_reports.png 600w,\n/if-blog-react/static/6a27827eb9a68a33e03fe7e5853f75f6/f5ece/write_reports.png 749w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>保存後にシェアします。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 320px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/109f34c8887ef0bf79de64d3de65b7ab/01387/share.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 121.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsSAAALEgHS3X78AAADxElEQVQ4y4WU22tcVRTG578Q0XeFFp+0gg+i2ARFq6VqC2oqQrEW05ZaRUXb0liSSi4IsWkxRqG1F5GCqJAHoS8igs0k+tCUzCV1cuZy5lxm5twve5/zuc6ea5Jpsocfe5911vpmrX3W3qknJk7j3Rtz2DVxBs9dOI/nL43jjSuXMHR1FgevzeKVb7/Crskz2Dn2CR47/+m2pAYmz2JgcgS7aR6cas6CicROkG2gZU/8mv5ddm8glV5cxEI6jYWlJSzQOt0iWd8m+9/E7Q0s9JBeWsQixaaJZE7JlQos00RD12A26jCNRgfbsuA5TRzbgt9aJ/4Cel+UJOTzedxbXcUqkbJsF7/PX8HY8CDOHd2Lk4dewuHXn8H06MfgAFSLQ7M53BCQTQ7VTqzdUSqVsLKygmw2K0g5boCb16awf/ABjHywD9+NH8PpI3twYfRDeCxGrupiueSg0vDx75qNpYINP+SIIo44bgpmMhnkcrmu4C8/zeDqzHHMX/8Sp46+iotfHMGtn78HYwzVSgm2WUfgubQlOlzbgKJUhVA7w3WCmlZHrfwPfvvhc7yzdwfeemEHhg88hemRE7BtRzgahiGCGefgUdSE8/6CqlYDfAlfnxvCoX2P4vibT2LP4w9i5MSQyFDXdBSLRbHuNzYJKqoOBEX8+M1HOPjyIzgw8BBee/ph3JwbEwFhGAriZMNoJHObvoINw8Kd9Dz++HUcl6eP4bP3n8XF0bfB6iudoPbYKNpXMGmbP2/dwNmTL2Juahiz44fx3v6duDxzClESSL+oJ6ttM9Q0DSx0IRVWUMgtQ8rfxVr+Dqqle9hy3E9QUZWOTx2M4DAoq2RdDexNyIEFLXTun6GqquKFywKsuXVq2gCaQUfQcxDEHH7EOngEiyNIniGetxT0eIhqaIMHITWuQmfXbpW2udokS287QZcEFSolcFzIstwV7OxZd98qvikS2FLQJwfJNxBwBivwxBaIMsnuU+nUiWKmE4xyaNEOR1sL8iiGyTzaeAcqfXWVZtm3UWPUAYaOjCzhv7qCfE2GpCsw6PpK2qlcLm9oGxIMqRLFiZCtx9AcurKcGApVbPnJ+U3+jT6O5yM0LYS6Dk/V4NKRjOlM9+nDpmCuEeF6NsRdPUJa5virxNHwYyq/56vQhRqvSWDLy2CFAv0bQynJkO7Dbh/SVRTyGDUnhOUxGITZouYwBCGjBJm4aZjrgjUaCOsEzZwEk4tjXYbJgzBkM8hm1pPY2u8FFJChwA6JH9naYkKw96E/ORHQzy/XI9b2+R9VKJpXbe9vhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"share\"\n        title=\"share\"\n        src=\"/if-blog-react/static/109f34c8887ef0bf79de64d3de65b7ab/01387/share.png\"\n        srcset=\"/if-blog-react/static/109f34c8887ef0bf79de64d3de65b7ab/c0399/share.png 100w,\n/if-blog-react/static/109f34c8887ef0bf79de64d3de65b7ab/9ec3c/share.png 200w,\n/if-blog-react/static/109f34c8887ef0bf79de64d3de65b7ab/01387/share.png 320w\"\n        sizes=\"(max-width: 320px) 100vw, 320px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>これだけの単純な作りです。</p>\n<h2 id=\"作った動機\"><a href=\"#%E4%BD%9C%E3%81%A3%E3%81%9F%E5%8B%95%E6%A9%9F\" aria-label=\"作った動機 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>作った動機</h2>\n<ul>\n<li>Firebaseを使いたかった</li>\n<li>本に出会える場を増やしたかった</li>\n</ul>\n<h4 id=\"1firebaseを使いたかった\"><a href=\"#1firebase%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F\" aria-label=\"1firebaseを使いたかった permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.Firebaseを使いたかった</h4>\n<p>単純にFirebaseのみでサービスを稼働させたかっただけです。これまでFirebase Authは使ったことがありました。これがすごく便利で、びっくりしました。今まで、アカウント管理のAPIを頑張って作ってたのを肩代わりしてくれるなんて。そこで、それ以外のサービスを使ってみようと言うのが動機です。<br>\n今回、Webアプリケーションで使えるDBやStorage、HostingなどFirebaseのサービスはほぼ使っています。すごく便利。使ってみた技術は、別の記事にまとめます。  </p>\n<h4 id=\"2本に出会える場を増やしたかった\"><a href=\"#2%E6%9C%AC%E3%81%AB%E5%87%BA%E4%BC%9A%E3%81%88%E3%82%8B%E5%A0%B4%E3%82%92%E5%A2%97%E3%82%84%E3%81%97%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F\" aria-label=\"2本に出会える場を増やしたかった permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.本に出会える場を増やしたかった</h4>\n<p>個人的な意見として、本とのファーストコンタクトは、タイトルや表紙、帯に書いてあるコメントなどパッと目に入ってくるものが多いです。本の感想やレビューを三行に絞ることで、書く側も読む側も気軽に使え、新たな本に出会える場となるのではないかと考えました。普段、本を読むことが少ない人は、こういった気軽な出会いから本を読んでみるのも良いのではないかと思います。  </p>\n<p>また、本を多く読む人も、多く読むからこそ、この本読んだけどどんな話だっけ？となることが多いかと思います。<br>\nそういった場面で、短く感想を残しておくことで、自分自身の読んだ本の記録にもなるかと思います。  </p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Firebaseを使うことで、実質コーディングしたのは、フロントのVue.jsだけでした。DBやストレージへのアクセス、アカウント管理周りなどをFirebaseに任せられることで、APIを書く必要がないのは、コーディングする上で大きな負荷の軽減となりました。無料でここまで使わせてくれるのは、なにかサービスを簡単に始めたい時はとても便利だと思います。</p>","id":"5cc2d0bc-06d9-5e63-b4a7-f179e5845a38","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_review/#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E6%A6%82%E8%A6%81\">サービス概要</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_review/#%E4%BD%BF%E3%81%84%E6%96%B9\">使い方</a></li>\n<li>\n<p><a href=\"/if-blog-react/edgwbs/book_reports_review/#%E4%BD%9C%E3%81%A3%E3%81%9F%E5%8B%95%E6%A9%9F\">作った動機</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_review/#1firebase%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F\">1.Firebaseを使いたかった</a></li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_review/#2%E6%9C%AC%E3%81%AB%E5%87%BA%E4%BC%9A%E3%81%88%E3%82%8B%E5%A0%B4%E3%82%92%E5%A2%97%E3%82%84%E3%81%97%E3%81%9F%E3%81%8B%E3%81%A3%E3%81%9F\">2.本に出会える場を増やしたかった</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/if-blog-react/edgwbs/book_reports_review/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"三行で読書感想文を書いて、SNSでシェアできるサービスを作った","date":"2019-09-24","tags":["WebApp","poem","firebase"]},"fields":{"slug":"/edgwbs/book_reports_review/"}}},{"node":{"excerpt":"autoencoderなどを作っていると、保存や推論を行う上での再利用性を考え、encoderとdecoderは分けてModelを作りたいことがある。 autoencoderの学習の際には、作成したencoderのModelとdecoderのModelを結合する。 Modelの結合は前はできなかった気がするが、できるようになっていたのでメモ。 Kerasのバージョンは、2.1.…","html":"<p>autoencoderなどを作っていると、保存や推論を行う上での再利用性を考え、encoderとdecoderは分けてModelを作りたいことがある。</p>\n<p>autoencoderの学習の際には、作成したencoderのModelとdecoderのModelを結合する。</p>\n<p>Modelの結合は前はできなかった気がするが、できるようになっていたのでメモ。</p>\n<p>Kerasのバージョンは、2.1.1</p>\n<p>まずは、シンプルなモデルを2つ作る。input→model1→model2→outputを作る。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">model1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    layer_input <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    layer_output <span class=\"token operator\">=</span> Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">)</span>\n    model <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> layer_output<span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> model\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">model2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    layer_input <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    layer_output <span class=\"token operator\">=</span> Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">)</span>\n    model <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> layer_output<span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> model</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>まず、model1へのインプットを作る。model1のアウトプットをmodel2のインプットにし、Modelのインスタンスを作る。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">m1 <span class=\"token operator\">=</span> model1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nm2 <span class=\"token operator\">=</span> model2<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ninp <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmodel1_output <span class=\"token operator\">=</span> m1<span class=\"token punctuation\">(</span>inp<span class=\"token punctuation\">)</span>\nout <span class=\"token operator\">=</span> m2<span class=\"token punctuation\">(</span>model1_output<span class=\"token punctuation\">)</span>\nmodel <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>inp<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>すると、こんな感じでモデルが結合できたのが確認できる。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Using TensorFlow backend.\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\ndense_1 <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">110</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params: <span class=\"token number\">110</span>\nTrainable params: <span class=\"token number\">110</span>\nNon-trainable params: <span class=\"token number\">0</span>\n_________________________________________________________________\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_2 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\ndense_2 <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">110</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params: <span class=\"token number\">110</span>\nTrainable params: <span class=\"token number\">110</span>\nNon-trainable params: <span class=\"token number\">0</span>\n_________________________________________________________________\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_3 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\nmodel_1 <span class=\"token punctuation\">(</span>Model<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">110</span>\n_________________________________________________________________\nmodel_2 <span class=\"token punctuation\">(</span>Model<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span>None, None, <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">110</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params: <span class=\"token number\">220</span>\nTrainable params: <span class=\"token number\">220</span>\nNon-trainable params: <span class=\"token number\">0</span>\n_________________________________________________________________</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>コード全体はこんな感じ。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Dense\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Model\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">model1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    layer_input <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    layer_output <span class=\"token operator\">=</span> Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">)</span>\n    model <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> layer_output<span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> model\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">model2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    layer_input <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    layer_output <span class=\"token operator\">=</span> Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">)</span>\n    model <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> layer_output<span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> model\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    m1 <span class=\"token operator\">=</span> model1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    m2 <span class=\"token operator\">=</span> model2<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    inp <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    x <span class=\"token operator\">=</span> m1<span class=\"token punctuation\">(</span>inp<span class=\"token punctuation\">)</span>\n    out <span class=\"token operator\">=</span> m2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n    model <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>inp<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">)</span>\n    model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n   main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>モデルインスタンスの再利用性が上がってて使いやすくなってる。  </p>","id":"62b1088b-68a6-5efb-b713-538fb6ee0bb2","tableOfContents":"","frontmatter":{"title":"kerasでモデルを結合する","date":"2019-09-23","tags":["keras","deeplearning"]},"fields":{"slug":"/neuralnet/combine_model/"}}},{"node":{"excerpt":"最新論文の情報を広く浅く集めたい場合の巡回するサイトたちをまとめておきます。 おすすめがあれば教えてください。 Google Scholar: https://scholar.google.com/schhp?hl=ja 研究者やキーワードが決まっていると探しやすい。ただ、ザッピングには向かない。 いろいろ論文の検索エンジン使ってたけど、結局これが残った。texの引用が楽 arXiv arXiv…","html":"<p>最新論文の情報を広く浅く集めたい場合の巡回するサイトたちをまとめておきます。<br>\nおすすめがあれば教えてください。</p>\n<p>Google Scholar: <a href=\"https://scholar.google.com/schhp?hl=ja\">https://scholar.google.com/schhp?hl=ja</a></p>\n<p>研究者やキーワードが決まっていると探しやすい。ただ、ザッピングには向かない。<br>\nいろいろ論文の検索エンジン使ってたけど、結局これが残った。texの引用が楽</p>\n<h2 id=\"arxiv\"><a href=\"#arxiv\" aria-label=\"arxiv permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>arXiv</h2>\n<h4 id=\"arxiv-1\"><a href=\"#arxiv-1\" aria-label=\"arxiv 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>arXiv</h4>\n<p><a href=\"https://arxiv.org/\">https://arxiv.org/</a></p>\n<p>トップページは慣れないとちょっと見づらい。有名な研究者で検索したものや分野で絞り込んだものをチェックするのが使いやすそう。</p>\n<h4 id=\"arxivtimes\"><a href=\"#arxivtimes\" aria-label=\"arxivtimes permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>arXivTimes</h4>\n<p><a href=\"https://medium.com/@arxivtimes\">https://medium.com/@arxivtimes</a></p>\n<p>日本語、arXivのまとめ系、ツイッター</p>\n<h4 id=\"論文まとめてくれてるgithub\"><a href=\"#%E8%AB%96%E6%96%87%E3%81%BE%E3%81%A8%E3%82%81%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%A6%E3%82%8Bgithub\" aria-label=\"論文まとめてくれてるgithub permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>論文まとめてくれてるGitHub</h4>\n<p><a href=\"https://github.com/dennybritz/deeplearning-papernotes\">https://github.com/dennybritz/deeplearning-papernotes</a></p>\n<p>arXivのまとめ。古いものは2011年から、新しいものは2018まで更新がある。</p>\n<h2 id=\"企業の論文\"><a href=\"#%E4%BC%81%E6%A5%AD%E3%81%AE%E8%AB%96%E6%96%87\" aria-label=\"企業の論文 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>企業の論文</h2>\n<h4 id=\"deepmind\"><a href=\"#deepmind\" aria-label=\"deepmind permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DeepMind</h4>\n<p><a href=\"https://deepmind.com/research/publications/\">https://deepmind.com/research/publications/</a></p>\n<h4 id=\"microsoft-research-publications\"><a href=\"#microsoft-research-publications\" aria-label=\"microsoft research publications permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Microsoft Research Publications</h4>\n<p><a href=\"http://research.microsoft.com/apps/catalog/default.aspx?t=publications&#x26;ra=47200\">http://research.microsoft.com/apps/catalog/default.aspx?t=publications&#x26;ra=47200</a></p>\n<h4 id=\"google-research-publications\"><a href=\"#google-research-publications\" aria-label=\"google research publications permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Research Publications</h4>\n<p><a href=\"http://research.google.com/pubs/ArtificialIntelligenceandMachineLearning.html\">http://research.google.com/pubs/ArtificialIntelligenceandMachineLearning.html</a></p>\n<h4 id=\"yahoo-labs\"><a href=\"#yahoo-labs\" aria-label=\"yahoo labs permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Yahoo! Labs</h4>\n<p><a href=\"http://labs.yahoo.com/publication/?area=machine-learning\">http://labs.yahoo.com/publication/?area=machine-learning</a></p>","id":"c6e4897e-6e6f-592a-908c-3bf2eb7a585a","tableOfContents":"<ul>\n<li>\n<p><a href=\"/if-blog-react/neuralnet/pepar_summary/#arxiv\">arXiv</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#arxiv-1\">arXiv</a></li>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#arxivtimes\">arXivTimes</a></li>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#%E8%AB%96%E6%96%87%E3%81%BE%E3%81%A8%E3%82%81%E3%81%A6%E3%81%8F%E3%82%8C%E3%81%A6%E3%82%8Bgithub\">論文まとめてくれてるGitHub</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/if-blog-react/neuralnet/pepar_summary/#%E4%BC%81%E6%A5%AD%E3%81%AE%E8%AB%96%E6%96%87\">企業の論文</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#deepmind\">DeepMind</a></li>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#microsoft-research-publications\">Microsoft Research Publications</a></li>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#google-research-publications\">Google Research Publications</a></li>\n<li><a href=\"/if-blog-react/neuralnet/pepar_summary/#yahoo-labs\">Yahoo! Labs</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"Deeplearningまわりの最新論文を浅く広くみてまわる","date":"2019-09-23","tags":["deeplearning"]},"fields":{"slug":"/neuralnet/pepar_summary/"}}},{"node":{"excerpt":"はじめに 自然言語処理シリーズの構文解析を読んでいきます。  全体の概要把握:1時間\n中身の細かいとこ：3時間\nという感じで読み進めて行こうと思います。 概要 構文解析を用いることで、単語の並びの背後にある文法的な構造を明らかにすることができる。構文解析を学ぶことで、自然言語処理で用いられる様々な先人の知恵を学習できる。 この本では以下のような構成となっている。 1章、はじめに…","html":"<h2 id=\"はじめに\"><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\" aria-label=\"はじめに permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>はじめに</h2>\n<p>自然言語処理シリーズの構文解析を読んでいきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 336px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/0a76326d12676389e9c6b3d655b8bc0e/da001/parse_front_cover.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 148.51190476190476%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIBAwQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAHuJasMBK06VcySGv/EABoQAQACAwEAAAAAAAAAAAAAAAECEAAREiH/2gAIAQEAAQUCX3qnBqRsHmVar//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/AYk//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8BKf/EABoQAAICAwAAAAAAAAAAAAAAAAEgADERQWH/2gAIAQEABj8CAm6zTcX/xAAbEAACAgMBAAAAAAAAAAAAAAAAARExECFBYf/aAAgBAQABPyGLYl+Sa2DwpBbbgmTsDIHY5hq7WP/aAAwDAQACAAMAAAAQy848/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREQMf/aAAgBAwEBPxBS5dp3P//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAgEBPxCGDGf/xAAcEAEAAgMBAQEAAAAAAAAAAAABABEhMUFRYXH/2gAIAQEAAT8QpqltIxg68hRaRxWvP35DIXzyLsi6S4SAo6pzAATTMPYpvHfkCeAL7DTFTZFxCxsYz//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"parse_front_cover\"\n        title=\"parse_front_cover\"\n        src=\"/if-blog-react/static/0a76326d12676389e9c6b3d655b8bc0e/da001/parse_front_cover.jpg\"\n        srcset=\"/if-blog-react/static/0a76326d12676389e9c6b3d655b8bc0e/5fb09/parse_front_cover.jpg 100w,\n/if-blog-react/static/0a76326d12676389e9c6b3d655b8bc0e/f544b/parse_front_cover.jpg 200w,\n/if-blog-react/static/0a76326d12676389e9c6b3d655b8bc0e/da001/parse_front_cover.jpg 336w\"\n        sizes=\"(max-width: 336px) 100vw, 336px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>全体の概要把握:1時間\n中身の細かいとこ：3時間\nという感じで読み進めて行こうと思います。</p>\n<h2 id=\"概要\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-label=\"概要 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h2>\n<p>構文解析を用いることで、単語の並びの背後にある文法的な構造を明らかにすることができる。構文解析を学ぶことで、自然言語処理で用いられる様々な先人の知恵を学習できる。</p>\n<p>この本では以下のような構成となっている。</p>\n<ul>\n<li>1章、はじめに</li>\n<li>2章、品詞タグ付けのための手法と、機械学習の基礎的な事項について</li>\n<li>3章、句構造解析について</li>\n<li>4章、依存構造解析</li>\n<li>5章、文法理論、深い構文解析</li>\n<li>6章、構文解析の応用例</li>\n<li>7章、構文解析ツールの紹介</li>\n<li>8章、モデルやアルゴリズムの学習用・評価用データに用いられるツリーバンクの紹介</li>\n</ul>\n<p>以下、各章の概要まとめです。</p>\n<h2 id=\"2章：品詞解析と機械学習\"><a href=\"#2%E7%AB%A0%EF%BC%9A%E5%93%81%E8%A9%9E%E8%A7%A3%E6%9E%90%E3%81%A8%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92\" aria-label=\"2章：品詞解析と機械学習 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2章：品詞解析と機械学習</h2>\n<p>品詞解析のためのさまざまな技術の解説し、その基盤となる機械学習の考え方と代表的なモデルを紹介する。</p>\n<p>品詞タグ付け：与えられた文章の各単語の品詞を判定し、品詞情報を付与する処理\n品詞タガー：品詞タグ付けを行うプログラム\nルールベースの手法：shoudの後には動詞がくると決めうちでタグ付けをする手法\n素性: 品詞判定の手がかりとして利用する情報</p>\n<h4 id=\"隠れマルコフモデル\"><a href=\"#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\" aria-label=\"隠れマルコフモデル permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>隠れマルコフモデル</h4>\n<p>機械学習に基づく品詞タグ付け手法の中で基本的なもの。\n単純な計算では、文長に対し計算量が指数関数的に増加する問題がある。</p>\n<h4 id=\"viterbiアルゴリズム\"><a href=\"#viterbi%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0\" aria-label=\"viterbiアルゴリズム permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Viterbiアルゴリズム</h4>\n<p>計算量増加の問題を解決。動的計画法の1種。\nアンダーフローの問題がある、この問題に対し、対数をとっても良いが計算が遅くなるというデメリットもある。</p>\n<h4 id=\"最大エントロピーモデル\"><a href=\"#%E6%9C%80%E5%A4%A7%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AD%E3%83%94%E3%83%BC%E3%83%A2%E3%83%87%E3%83%AB\" aria-label=\"最大エントロピーモデル permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最大エントロピーモデル</h4>\n<p>最大エントロピーモデルは、品詞判定に役立つ手がかりを素性として利用し予測できるアルゴリズムの一種。品詞の前後のつながりを考慮せずに予測するというモデル。\n計算コストは少ないが、素性を柔軟に設計できないため精度が低いという問題点がある。\n自然言語処理では、実装が簡単なことからSGDがよく用いられる。学習データの数が多い場合には、短時間で最適化を行うことができる。</p>\n<h4 id=\"最大エントロピーマルコフモデル\"><a href=\"#%E6%9C%80%E5%A4%A7%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AD%E3%83%94%E3%83%BC%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\" aria-label=\"最大エントロピーマルコフモデル permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最大エントロピーマルコフモデル</h4>\n<p>最大エントロピーモデルに、品詞のつながりを考慮させ正確な予測を行うことできるように改良されたモデル。\n先行する単語の品詞に関数情報を素性として利用するできるが、最初にタグ付けを間違えると、その誤りによって別の誤りが引き起こされてしまう問題がある。</p>\n<h4 id=\"条件付き確率場crf\"><a href=\"#%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E7%A2%BA%E7%8E%87%E5%A0%B4crf\" aria-label=\"条件付き確率場crf permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>条件付き確率場(CRF)</h4>\n<p>各単語の品詞を個別に予測するのではなく、文全体の品詞列全体を一度に予測しようとするアプローチに基づく代表的な確率モデル。</p>\n<h4 id=\"構造化パーセプトロン\"><a href=\"#%E6%A7%8B%E9%80%A0%E5%8C%96%E3%83%91%E3%83%BC%E3%82%BB%E3%83%97%E3%83%88%E3%83%AD%E3%83%B3\" aria-label=\"構造化パーセプトロン permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>構造化パーセプトロン</h4>\n<p>CRFでは、登場する品詞列すべてに対し確率を求めるが、もっとも正解である確率の高い品詞列さえ得られれば良いという状況もある。そのような状況では、構造化パーセプトロンが役にたつ。動的計画法を用いて品詞タグ付けを行う。</p>\n<h4 id=\"ビーム探索\"><a href=\"#%E3%83%93%E3%83%BC%E3%83%A0%E6%8E%A2%E7%B4%A2\" aria-label=\"ビーム探索 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ビーム探索</h4>\n<p>構造化パーセプトロンでは動的計画法を用いて品詞タグ付けを行ったが、素性が局所的な場合には、動的計画法が使えない。そこで、非局所的な様々な素性を利用するためによく用いられるのがビーム探索である。似たような手法として、Max Violationがある。</p>\n<h4 id=\"生コーパスを利用した学習\"><a href=\"#%E7%94%9F%E3%82%B3%E3%83%BC%E3%83%91%E3%82%B9%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E5%AD%A6%E7%BF%92\" aria-label=\"生コーパスを利用した学習 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>生コーパスを利用した学習</h4>\n<p>これまでの学習は、コーパスを前提にしたものだった。しかしコーパスの構築には膨大な時間がかかる。与えられた文章のみで学習する手法を、半教師あり学習と呼ぶ。</p>\n<h4 id=\"自己学習\"><a href=\"#%E8%87%AA%E5%B7%B1%E5%AD%A6%E7%BF%92\" aria-label=\"自己学習 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>自己学習</h4>\n<p>生コーパスを用いる学習に自己学習と呼ばれる方法がある。\nこれは、CRFや構造化パーセプトロンでは精度向上に効果がないが、隠れマルコフモデルのような生成モデルでは大きな精度向上を得ることができる。これは、生成モデルの場合、EMアルゴリズムの1ステップに対応しているからである。隠れマルコフモデルで自己学習を行う場合、Baum-Welchアルゴリズムを用いる。</p>\n<h2 id=\"3章：句構造解析\"><a href=\"#3%E7%AB%A0%EF%BC%9A%E5%8F%A5%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\" aria-label=\"3章：句構造解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3章：句構造解析</h2>\n<p>構文解析の表現方法の1つである句構造と、それに基づく構文解析の手法について説明する。</p>\n<h4 id=\"句構造\"><a href=\"#%E5%8F%A5%E6%A7%8B%E9%80%A0\" aria-label=\"句構造 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>句構造</h4>\n<p>文中の句同士の包含関係を階層的にまとめあげることで、その構造を明らかにする。\n適切な句構造を得るための問題を2つに分けると、与えられた文に対して文法上可能な全ての句構造を計算することと、それらの中から最も適切な句構造を選択することとなる。</p>\n<h4 id=\"文脈自由文法\"><a href=\"#%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95\" aria-label=\"文脈自由文法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文脈自由文法</h4>\n<p>文の句構造を表現するための、最も基本的な文法の一つ。\n文脈自由文法のためのボトムアップな構文解析手法の一つであるCKY法と、任意の文脈自由文法を用いてトップダウンに構文解析を行うことが可能なEarly法がある。</p>\n<h4 id=\"確率文脈自由文法pcfg\"><a href=\"#%E7%A2%BA%E7%8E%87%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95pcfg\" aria-label=\"確率文脈自由文法pcfg permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>確率文脈自由文法(PCFG)</h4>\n<p>句構造を列挙した上で、最も確からしい句構造を選択する枠組みの1つ</p>\n<h4 id=\"確率文脈自由文法pcfgの拡張\"><a href=\"#%E7%A2%BA%E7%8E%87%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95pcfg%E3%81%AE%E6%8B%A1%E5%BC%B5\" aria-label=\"確率文脈自由文法pcfgの拡張 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>確率文脈自由文法(PCFG)の拡張</h4>\n<p>PCFGを拡張した、Collins Parserの手法について解説\n生成的な確率モデルを注意深く設計することで、正しい構文木にたいして大きな確率がわりあてられるようにする。</p>\n<h4 id=\"識別モデルによる際順位付け\"><a href=\"#%E8%AD%98%E5%88%A5%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AB%E3%82%88%E3%82%8B%E9%9A%9B%E9%A0%86%E4%BD%8D%E4%BB%98%E3%81%91\" aria-label=\"識別モデルによる際順位付け permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>識別モデルによる際順位付け</h4>\n<p>正しい構文木とそうでない構文木を区別する特徴はいくつかあるが、Collins Parserでは限られたものしか考慮することができない。</p>\n<h4 id=\"評価法\"><a href=\"#%E8%A9%95%E4%BE%A1%E6%B3%95\" aria-label=\"評価法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>評価法</h4>\n<p>句構造解析の精度の評価には、構文木を構成する句の適合率(precision)と再現率(recall)がよく用いられる。</p>\n<h2 id=\"4章依存構造解析\"><a href=\"#4%E7%AB%A0%E4%BE%9D%E5%AD%98%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\" aria-label=\"4章依存構造解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4章:依存構造解析</h2>\n<p>依存構造とは、文中の単語間の関係をグラフで表したものである。</p>\n<h4 id=\"cky法\"><a href=\"#cky%E6%B3%95\" aria-label=\"cky法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CKY法</h4>\n<p>依存構造を句構造だと考え解析する。</p>\n<h4 id=\"eisner法\"><a href=\"#eisner%E6%B3%95\" aria-label=\"eisner法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Eisner法</h4>\n<p>同じ出力を得るための解析プロセスが複数存在することを、擬似曖昧性と呼ぶ。\n依存構文解析において、擬似曖昧性が生じないようにCKY法を改良したものがEisner法である。</p>\n<h4 id=\"mst法\"><a href=\"#mst%E6%B3%95\" aria-label=\"mst法 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MST法</h4>\n<p>これまでの手法は、句構造解析のアルゴリズムを依存構造解析に応用したものであったが、依存構文解析に特有の手法として、最大全域木(MST)法を応用したものが知られている。\n最大全域木とは、エッジにスコアが与えられたグラフを入力として、全ノードを被覆する木(=全域木)のうち、スコアのわが最大となるものを求めるアルゴリズムである。</p>\n<h4 id=\"遷移型依存構造解析\"><a href=\"#%E9%81%B7%E7%A7%BB%E5%9E%8B%E4%BE%9D%E5%AD%98%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\" aria-label=\"遷移型依存構造解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>遷移型依存構造解析</h4>\n<p>句造像解析と同様のアルゴリズムを依存構造解析でも考えることができる。</p>\n<h4 id=\"日本語構文解析\"><a href=\"#%E6%97%A5%E6%9C%AC%E8%AA%9E%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\" aria-label=\"日本語構文解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>日本語構文解析</h4>\n<p>p102(スキップ)</p>\n<h4 id=\"評価法-1\"><a href=\"#%E8%A9%95%E4%BE%A1%E6%B3%95-1\" aria-label=\"評価法 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>評価法</h4>\n<p>依存構造解析の評価には、ラベル付きかかり受け精度およびラベルなしかかり受け精度が用いられる。</p>\n<h2 id=\"5章：文法理論、深い構文解析\"><a href=\"#5%E7%AB%A0%EF%BC%9A%E6%96%87%E6%B3%95%E7%90%86%E8%AB%96%E3%80%81%E6%B7%B1%E3%81%84%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\" aria-label=\"5章：文法理論、深い構文解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5章：文法理論、深い構文解析</h2>\n<p>3、4章で解説した、句構造・依存構造では明示されない意味的構造をも計算する、構文解析のことを、<strong>深い構文解析</strong>と呼ぶ。</p>\n<h4 id=\"組み合わせ範疇文法ccg\"><a href=\"#%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E7%AF%84%E7%96%87%E6%96%87%E6%B3%95ccg\" aria-label=\"組み合わせ範疇文法ccg permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>組み合わせ範疇文法(CCG)</h4>\n<p>組み合わせ範疇文法(CCG)とは、各単語にその文法機能を表すカテゴリを与え、そのカテゴリを組み合わせることで文の構造を計算する。</p>\n<h4 id=\"主辞駆動句構造文法hpsg\"><a href=\"#%E4%B8%BB%E8%BE%9E%E9%A7%86%E5%8B%95%E5%8F%A5%E6%A7%8B%E9%80%A0%E6%96%87%E6%B3%95hpsg\" aria-label=\"主辞駆動句構造文法hpsg permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>主辞駆動句構造文法(HPSG)</h4>\n<p>主辞駆動句構造文法(HPSG)とは、主辞(句の中で意味的もしくは文法的に中心的な役割を果たす語)が持つ文法機能を素性構造というデータ構造で表し、それに基づき文全体の構造を決定する文法理論である。素性構造では、C++の構造体やオブジェクト指向言語におけるクラスに似た形でデータを表す。</p>\n<h4 id=\"深い構文解析\"><a href=\"#%E6%B7%B1%E3%81%84%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\" aria-label=\"深い構文解析 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>深い構文解析</h4>\n<p>CCGやHPSGのような文法理論を用いて、CFGより多くの情報をもたせた文法構造を解析する手法を深い文法構造と呼ぶ。</p>","id":"f9614d7a-0f59-52eb-b7ef-12443223616f","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\">はじめに</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%A6%82%E8%A6%81\">概要</a></li>\n<li>\n<p><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#2%E7%AB%A0%EF%BC%9A%E5%93%81%E8%A9%9E%E8%A7%A3%E6%9E%90%E3%81%A8%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92\">2章：品詞解析と機械学習</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\">隠れマルコフモデル</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#viterbi%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0\">Viterbiアルゴリズム</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%9C%80%E5%A4%A7%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AD%E3%83%94%E3%83%BC%E3%83%A2%E3%83%87%E3%83%AB\">最大エントロピーモデル</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%9C%80%E5%A4%A7%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AD%E3%83%94%E3%83%BC%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\">最大エントロピーマルコフモデル</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E7%A2%BA%E7%8E%87%E5%A0%B4crf\">条件付き確率場(CRF)</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%A7%8B%E9%80%A0%E5%8C%96%E3%83%91%E3%83%BC%E3%82%BB%E3%83%97%E3%83%88%E3%83%AD%E3%83%B3\">構造化パーセプトロン</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E3%83%93%E3%83%BC%E3%83%A0%E6%8E%A2%E7%B4%A2\">ビーム探索</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E7%94%9F%E3%82%B3%E3%83%BC%E3%83%91%E3%82%B9%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E5%AD%A6%E7%BF%92\">生コーパスを利用した学習</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E8%87%AA%E5%B7%B1%E5%AD%A6%E7%BF%92\">自己学習</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#3%E7%AB%A0%EF%BC%9A%E5%8F%A5%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\">3章：句構造解析</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E5%8F%A5%E6%A7%8B%E9%80%A0\">句構造</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95\">文脈自由文法</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E7%A2%BA%E7%8E%87%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95pcfg\">確率文脈自由文法(PCFG)</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E7%A2%BA%E7%8E%87%E6%96%87%E8%84%88%E8%87%AA%E7%94%B1%E6%96%87%E6%B3%95pcfg%E3%81%AE%E6%8B%A1%E5%BC%B5\">確率文脈自由文法(PCFG)の拡張</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E8%AD%98%E5%88%A5%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AB%E3%82%88%E3%82%8B%E9%9A%9B%E9%A0%86%E4%BD%8D%E4%BB%98%E3%81%91\">識別モデルによる際順位付け</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E8%A9%95%E4%BE%A1%E6%B3%95\">評価法</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#4%E7%AB%A0%E4%BE%9D%E5%AD%98%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\">4章:依存構造解析</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#cky%E6%B3%95\">CKY法</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#eisner%E6%B3%95\">Eisner法</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#mst%E6%B3%95\">MST法</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E9%81%B7%E7%A7%BB%E5%9E%8B%E4%BE%9D%E5%AD%98%E6%A7%8B%E9%80%A0%E8%A7%A3%E6%9E%90\">遷移型依存構造解析</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%97%A5%E6%9C%AC%E8%AA%9E%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\">日本語構文解析</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E8%A9%95%E4%BE%A1%E6%B3%95-1\">評価法</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#5%E7%AB%A0%EF%BC%9A%E6%96%87%E6%B3%95%E7%90%86%E8%AB%96%E3%80%81%E6%B7%B1%E3%81%84%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\">5章：文法理論、深い構文解析</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E7%AF%84%E7%96%87%E6%96%87%E6%B3%95ccg\">組み合わせ範疇文法(CCG)</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E4%B8%BB%E8%BE%9E%E9%A7%86%E5%8B%95%E5%8F%A5%E6%A7%8B%E9%80%A0%E6%96%87%E6%B3%95hpsg\">主辞駆動句構造文法(HPSG)</a></li>\n<li><a href=\"/if-blog-react/nlp/nlp_parse_overview-1/#%E6%B7%B1%E3%81%84%E6%A7%8B%E6%96%87%E8%A7%A3%E6%9E%90\">深い構文解析</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"自然言語処理シリーズの構文解析を読む（概要）","date":"2019-09-23","tags":["nlp","構文解析"]},"fields":{"slug":"/nlp/nlp_parse_overview-1/"}}},{"node":{"excerpt":"文章生成にchar-level lstmを使ってみる。英語ではうまくいっている例があるが日本語では難しい。これは、日本語は英語に比べ文字数が多く、ニューラルネットワークの次元数(パラメータ数)が増やす必要があるのが原因の1つだと思う。また、次元削減のため、日本語では文章を単語に区切り単語をベクトル化し、lstm…","html":"<p>文章生成にchar-level lstmを使ってみる。英語ではうまくいっている例があるが日本語では難しい。これは、日本語は英語に比べ文字数が多く、ニューラルネットワークの次元数(パラメータ数)が増やす必要があるのが原因の1つだと思う。また、次元削減のため、日本語では文章を単語に区切り単語をベクトル化し、lstmで文章を生成する手法もあるが、単語に区切る時点でしゃべり言葉やネットの言葉ではうまく区切れないという問題がある。そこで、日本語の文字を画像として生成し、その画像をauto-encoderを用いてベクトル化することで、文字のベクトル化を行い、lstmに食わせるという手法を試して見ようと思う。<br>\n今回は、auto-encodeを用いた文字レベルのベクトル化までを行ってみようと思う。<br>\nコードはここ、<a href=\"https://github.com/if001/fifc.git\">https://github.com/if001/fifc.git</a>  </p>\n<p>以下の3工程で行う。</p>\n<ul>\n<li>フォントファイルからフォント画像を生成</li>\n<li>文字列とフォント画像をマッピング</li>\n<li>フォント画像から特徴量を生成</li>\n</ul>\n<h2 id=\"フォントファイルからフォント画像を生成\"><a href=\"#%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8B%E3%82%89%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%82%92%E7%94%9F%E6%88%90\" aria-label=\"フォントファイルからフォント画像を生成 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フォントファイルからフォント画像を生成</h2>\n<p>フォントファイルは、PILのImageFontの<a href=\"https://pillow.readthedocs.io/en/3.0.x/reference/ImageFont.html#PIL.ImageFont.truetype\">turetype</a>を使い読み込むことができる。<br>\nフォントファイルとフォントのサイズを引数に与えることで、fontオブジェクトが生成できる。  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> ImageFont\nfont_size<span class=\"token operator\">=</span><span class=\"token number\">28</span>\nfont <span class=\"token operator\">=</span> ImageFont<span class=\"token punctuation\">.</span>truetype<span class=\"token punctuation\">(</span>font_file<span class=\"token punctuation\">,</span> font_size<span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'unic'</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>読み込んだフォントは下記のように保存する。  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\npict_height<span class=\"token operator\">=</span><span class=\"token number\">28</span>\npict_width<span class=\"token operator\">=</span><span class=\"token number\">28</span>\nimage <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>pict_height<span class=\"token punctuation\">,</span> pict_width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndraw <span class=\"token operator\">=</span> ImageDraw<span class=\"token punctuation\">.</span>Draw<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\ndraw<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">,</span> yomi<span class=\"token punctuation\">,</span> font<span class=\"token operator\">=</span>font<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token string\">'#000000'</span><span class=\"token punctuation\">)</span>\nimage<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"./font\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PNG'</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Image.new()</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>で空のイメージを生成し、</p>\n<p>Drawオブジェクトに対しの<a href=\"https://pillow.readthedocs.io/en/3.0.x/reference/ImageDraw.html#PIL.ImageDraw.PIL.ImageDraw.Draw.text\">text関数</a>を用いてフォントファイルを書き込む。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">draw.text(pos, yomi, font=font, fill=&#39;#000000&#39;)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>引数は、上記のtext関数のリンクを参照。  </p>\n<p>保存するファイル名は、以下のように文字を16進数変換したものを使う。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">yomi<span class=\"token operator\">=</span><span class=\"token string\">\"歩\"</span>\nbytes_yomi <span class=\"token operator\">=</span> yomi<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span> <span class=\"token string\">'e6ada9'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"文字列とフォント画像をマッピング\"><a href=\"#%E6%96%87%E5%AD%97%E5%88%97%E3%81%A8%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%82%92%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0\" aria-label=\"文字列とフォント画像をマッピング permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文字列とフォント画像をマッピング</h2>\n<p>ファイル名を読み仮名を16進数変換し保存しているので、文字から毎回画像ファイルを読み込んでも良いが、高速に呼び出せるように、1文字と画像をファイルとkvsを使ってマッピングしておく。<br>\nkvsにはplyvelを使う。以下のようにインスタンス化する。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> plyvel\ndb <span class=\"token operator\">=</span> plyvel<span class=\"token punctuation\">.</span>DB<span class=\"token punctuation\">(</span>db_path<span class=\"token punctuation\">,</span> create_if_missing<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>以下のように、保存と取り出しを行う。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">db<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 保存</span>\ndb<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 取り出す</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"フォント画像から特徴量を生成\"><a href=\"#%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%81%8B%E3%82%89%E7%89%B9%E5%BE%B4%E9%87%8F%E3%82%92%E7%94%9F%E6%88%90\" aria-label=\"フォント画像から特徴量を生成 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フォント画像から特徴量を生成</h2>\n<p>auto-encoderを使って、保存した画像から特徴量を抽出する。<br>\nモデルの構造はkerasの公式ブログを参考にし、以下の構造とした。  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 365px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/6c93e6dd2faa2330fe92b304635dd044/e8713/auto-encoder-img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 629.8630136986301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAB+CAYAAAAk5jExAAAACXBIWXMAAAsSAAALEgHS3X78AAAIsklEQVRo3q2aCVMUOxCA5///L0pRBBQ8EOQQvDkFFBadvPlifft6s5nZWd+bqlQyOXo6faczTUppQmnbNtcPDw+Tz58/T75//z65urqanJ6e5sL7xcVFLpeXl5OPHz9O11hTmlQ89/f36ezsLL158ybt7e2lm5ub1C1Or169yu/7+/vp+Pg4ffr0KdUeALYUHuoOYPvly5e2A9J2i9rz8/O2w6p9//5922Hafv36NY9/+PBhusaaMsWQvj/9Kd3e3mbMLGD87du33H99fZ0L/eU6MUwRaO3pMKxusTa/KQepAUDpiJ9+/PiRnj9/np48eZJ+/vw57e9IMYyhnZPJJHW0ygs6WqWTk5MMFCAd/XI5ODjIjBoNsBObtLOzk96+fZvevXuXF9NHW04fHR3VAdoRSyd/mQEWMAYzMJVRYFxb26QRD7TjI2Oe5u7uLi+oFTD6/ft32t7eTk+fPp2K1NCaBlogYzBAeZP4tNkupRPkTEf6aJfzKNC6YVAG0EH79evX+R31o/ZDiA9MefnyZdrd3c3qyDjz6WdOBsgCsPBLYmYNZhQBx/lxHcKfuQyd+krJlKG5C7msfCHIbE+Ag1wu5Yins4mZSWgLmB0eHmaadTYxbxdaR1XtlUMnIRZwD5p0ZisLMW2YBLa0I8Be4+AgRhYmCBRsKWBmXWJouynR9h2hRohhCBjCRTBXHWvbndKwxLLcBsCwOiV5yrlTDOEcDIDoYAMjbIMhgry2tpZJQR9jFuaydoqhNIM2YMIEOIkjkl5aGNQUmjIGxtAZxWDOr1+//gWIDWQx4sFkOIkqoVaoolrCO2PYQ1UPG8lHZgCyZRawnWj+3T4fAxO2WI5Ro35VpvxXe9grNoiFGEDf9fX1tLKykkkjU2qiU/UpqB3Mwffq3dgm23aLtPu0peqkAALxITg173wELssUaLrQSfHALRZLeLFDDcWQPt5HOymAwghUDRoajoC9vgPSVM0XIsPEWJgMUBexRbRFkrCGsXIdaxqkXPmiqFJuGewAiN+gzRztZFRV5TX7FKQeBiCgagi1/SyEZltbWxk4bpUaLXI+zGJ9g7phRClyURXkncKYxpaCHtNfzqPduHdoIu3iO/RCiNmqtCvn2QbWqFBEPzIqFKlZXTCRSVhuaPbs2bMsQvTxgZrFXuik1BCYAg2hnfZvoZOKg2CiIdXLwQy4CfEXAqxtWauCkTA+hDn0afIXOqm+x5B4KXvINinQTx1GZ3kw9Tgpja1zY5mxh8gPBI+RlY4edaIN3aAlxZibcdrQd85JAQw1AzBqBVboLzVA+AjigzrajyoSnsw5KaSdzhiVygixZVzsY6Sr0BuVNZGzfKUW80UnpZo513qOKeXj5NIeRgA1GW5Kv8BktqI9RA4RZswUbVUSMozyejAIusA5mETR02nesINo0aijGQwCQzDQXXp0iGI0yo06gGZ4Jqatl4tHs9LRV41DH4M8+Cx9Xo6MwQBAS7B58eJFPpqBoSermmHoNV/osuEI2+VdAfeAs5Q9jKcAuKk2ePCGMaPtIQXhZcsGShoHw9+45ZJco5IYQ/HhIIaKjJaaGkHnFPro0aOMOYCjSFUxjFoC7UwBsF0AaAdjuAwJaomMpmSG4Yj2DvqBIW3P0pubm7nt2aUXoGpnHGgtIzyX0KYuDURVlxFqfIThGnSLoYjhnmHdIIaRY8Yx5Xm5tIej/DLYGBazzRgfKuT0D9rD+DUAQXAwI1rQSRmw0xezcwtVj8XGfcaDAOUdtQMwuxgNENohQjIAbOA09DMJpL8ZBNinfn3x4aA9LEVHJwU2cHhjYyNjrIEY5HLNfEEraOmRDAw9J1OWjg89XHvohjmopAH80vGhhgF5E1OY44l/VBLjf40Py2MWha3zoCUE7dI36rP1XHwIwfVoOnMTQKYIzNLFAABmQeeZcA5MGPQcbPxHPEjbrDF92EHFiACK8Wp8aEQas5ZlfGiusBxnbC4+LI9nQ/GhoV6cPxgfegCnMEbYi9mX4zBGIAvjQyayDb0eNZqBUGO5wbSWIugN52AQDACIR1/jHPp4H0xi9MWHJi6MZ2KgPphmqamPRzCKZh/AtGP/wpRp38OW+66M5uwhX4/+17aRg/cpq6urmbtxTlkDq4HQqhdbUe2i6nkxg4pBQ5gV1VOlyJl24z5KvDNhEW1qJoIZxzLe4TK186j9WGOIEbcct82YxtYEm3OqW47qVKbsh+LDvjR/MxRkgh0fgymPHz/OYgGWxoVVA1uTQ82ZW/RYwZbop7106h7uYXRlCjV2EIZA06WcVGkfTd+r032XC3PhXN8DCdj+0Nyq1yu5ps2L8WFpgMtYccYFxCSuBXGBbhhZczZxHBLMuIDIVZgAYDTCiy+K9KOPMQpBPHU1iWGaBfXRsNKOl9N+0PSVwacxzwxAHZGJoFhTDEf4cOx3nr5ndCgyNn9YTd172aqDAgvoZHyota5dtvYmMbRx0NMQxbADtYN2OKulLqxhjEXHZCAPQ0al7i3KmvbQU3y0k9D1r++XMVej75e9R/bazdpfE5AvhBgnFe2hc+PafL8MXVQhVU+rYpsCk+LPAIw7x5o50/tl1MjLfsRE9cMBacJIt/BO3EhNbKj64dCy12Oi5+GY4bQYNajPesBynnFkg6VBeGsxtqbKoD1ee5RrPGP3cpnF6CkPFoft6h6G7ph775e9hYSraAW0gpOSoCaDg07K0E0aIw0wQpu59NEsJnZllkncpVNVCrApUyN9+2rpgaXsoSnT0fbQfGHMJmkIjA8JRaBtPFQ6T0Mxd78cb7/YolGX0Rltiv7FK+ReJ4UqYeuQOdQLzFA//w3xaEY/FhyjgcrNOSlTAliXaE3i/zZg43u0MN71LcUUaCdn/+p+Of5+4P82/ATFOBh5bKsGS6WAGpawDQXb87JWCWdVS/XNqF50UgAzMqDIdXSafvTac8tCrwe3YorK850u1T4+VAP4D7H58e/Z8+LLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"auto-encoder-img\"\n        title=\"auto-encoder-img\"\n        src=\"/if-blog-react/static/6c93e6dd2faa2330fe92b304635dd044/e8713/auto-encoder-img.png\"\n        srcset=\"/if-blog-react/static/6c93e6dd2faa2330fe92b304635dd044/c0399/auto-encoder-img.png 100w,\n/if-blog-react/static/6c93e6dd2faa2330fe92b304635dd044/9ec3c/auto-encoder-img.png 200w,\n/if-blog-react/static/6c93e6dd2faa2330fe92b304635dd044/e8713/auto-encoder-img.png 365w\"\n        sizes=\"(max-width: 365px) 100vw, 365px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>各層の次元は以下のようにした。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">font_size <span class=\"token operator\">=</span> <span class=\"token number\">32</span>\ninput_img <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>font_size<span class=\"token punctuation\">,</span> font_size<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>input_img<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> BatchNormalization<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> BatchNormalization<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>hidden_dim<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nencoded <span class=\"token operator\">=</span> MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"encoder\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"decoder\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>encoded<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> UpSampling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> BatchNormalization<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> UpSampling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> BatchNormalization<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> ReLU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> UpSampling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\ndecoded <span class=\"token operator\">=</span> Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'sigmoid'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nautoencoder <span class=\"token operator\">=</span> Model<span class=\"token punctuation\">(</span>input_img<span class=\"token punctuation\">,</span> decoded<span class=\"token punctuation\">)</span>\nautoencoder<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"学習\"><a href=\"#%E5%AD%A6%E7%BF%92\" aria-label=\"学習 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>学習</h3>\n<p>損失関数と最適化関数はそれぞれ、mean<em>squared</em>errorとadamを用いた。  </p>\n<p>教師データとバリデーションデータはそれぞれ、66918個、16730個とした。また、バッチサイズは128とした。<br>\n学習は、kerasのearlystoppingを使いval_lossが減少がなくなるまで行った。  </p>\n<h3 id=\"結果\"><a href=\"#%E7%B5%90%E6%9E%9C\" aria-label=\"結果 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結果</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/8ff1e/training_log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABhklEQVQ4y6VTi27DIAzs//9ktaqqtDUByssESG42WdqkzTZpQzrZkPiwz+YAXuM4Ypom/HcJx0GclBK01iCK8J7gAzVrbgSlCdqkH+zs55wb6WFObOLgAOsqgivwNjekmJF9RLaeEXZRXAAZC4pxJmwZDgPUR4fKwRiID1YoRTTZQZ0xjagcT0QPQqk9Bo+xzGlPv+B5Vb5gQ7houDRGbPOfsP4em84eIYRmXzKUD9LtZY+dri+EhWWwjtB1Pay1d9JNhsaYTQbfjcVCmIKF6ju8nU5QSiGum9JK4INNhr8QOi9T4XA8HnE+n/c1bAO+0nAPd4k4gaVUx8SvXZaU//haxucuZ56j9/6KjixsTvA8PmtQLRi+UDh45Isf4NHN5UG4lBJimIOmglAiYk1sqVnH9sYwOb5AzhVxyWmVobCLsKJJz6Mgz0j13Dnea6XhnUd/7RBYL80dvd0MetXzZGjWXnGX5/HZaCiPu9aKgctvNg+tm+IbJrhcLm0v/5VSm7+2y4R8AhFrmPGG0fNHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"training_log\"\n        title=\"training_log\"\n        src=\"/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/c7805/training_log.png\"\n        srcset=\"/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/c0399/training_log.png 100w,\n/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/9ec3c/training_log.png 200w,\n/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/c7805/training_log.png 400w,\n/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/34e8a/training_log.png 600w,\n/if-blog-react/static/8cf52511ad74663f240aa9bb0725cd04/8ff1e/training_log.png 800w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>最中的なスコア   </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">epoch :4  \nacc :0.591411  \nloss :0.046486  \nval_acc :0.529843  \nval_loss:0.073542  </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>だいぶ早めに学習が打ち切られているのがわかる。<br>\n2epoch目くらいからほとんどlossもaccも変化しなくなっている。次元数や層の数が少なくパラメタが足りないのか???</p>\n<p>一応デコードされた文字を確認しておく。  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 64px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/a38f3e2fe26a446a0d5fd3f5d539387b/c5296/decoded_char.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 500%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAABkCAIAAAAJyYebAAAACXBIWXMAAAsSAAALEgHS3X78AAANRUlEQVRYw3XYebSW8xYH8B9LaaVoWiu1lESSwtJKpQwRtcpRKUWFBkmTSmYqlFQ4GUqU4UbDLTSZSwMuoUkTDcgshFApkXM/z7vfe7LWvff54z2/932e/dt7f/d3f/fvOenPP//8/vvvv/322x9//HHfvn27d+/eu3evHy1+//13v+zZs+enn376/PPPP/nkk/fff3/ZsmVbtmz5+uuvmaRdu3bdeeed/fv3f+SRR5599tkLLrjgwgsvbNq0qc8HHnjghx9+GDdu3NVXX3399dd74JZbbmnRokWzZs0uuuiie+65J61fv/7RRx996qmnpkyZsn379qKioqVLl1522WUWPH/zzTdPPPHEyJEjX3/99aLctW7duueff95CaGnt2rXcDhgw4NZbb/3yyy8Fs2LFiquuuioe/e6773i49NJLH3zwQWH//PPPdrGXWzJKv/322+OPP37ffffNnz9/5cqVvXr1+vDDD9u0abN69Wp57ty5U1APPfTQzTff/M/ctWTJkrZt2y5evPiDDz5INrPr3Xff7QZjPnmoV69e9+7dn3vuuf379wNi1qxZN9100/Llyz0p5rPOOks4r7zySvrjjz9eeumlyZMnr1q1Cpi9e/eGQs+ePSNshRg1atS8efMefvhhru69914RAdgtFUkg6dq167XXXgtPnvv06bNhw4Yrr7wyjD/++OOOHTvKqLCwcO7cuTfccMNnn33GrVu8prfffhtgvvTo0ePll1+WM8BsF5BI6vbbb7eeOnXqk08+yaciK55fVDFt2rTpnHPOGTZsWLt27W688cb69evDo0mTJip52223CfuSSy7ZunWrcthRUorSqlWrK664AguSPaS6aNEiOIkEn9AGyfhUCIsvvvjCL5C3xbZt2/y+Y8cObhUiwZM9kDxa9F/XX3/95QHGRf/rSvEHGdFrxowZnTt3Fpv8BTl27NjI/I477kBvRZk4ceLQoUOBqqKSSqIFgFSHDx+usO+++y4CnnfeeX786quv3J05cybAX3jhBdmhIzgHDx6MKtJJn376qdKfeuqpSAfJCKRbt24YbqFsr776qijs9csvv8RdBcPCA2GDFCTqLkhfkRmEFmGgFjoxUvA5cODA+Jq0scDq1KnD+dNPPx17yRx7LQCxceNGhBNtsbGwsSMzXrhwIbcnn3wyehXf5jmM1UZ6HsDKaFKfoHrjjTcOhH3xxRfrxyCdzy5durAJAvtECcgVbw3tQCSppCcKCgqg5zsOxF5hbC8PaCm6E8ZQgB9eHPCsASKkcCVVxIh9GVCI8OnCJV89bJEZS0CvWXz00UeQ0IC0qnXr1hEqJqqw7UCrltOnTydY2GKRGevvfv36WfgE7LHHHnv//fcTIJ79aDuNtWDBAoh6UleonCxgmZQb11q2bEkZIjBoabVIQfE16XXXXUe6dFjUKcTw119/Tc8884zuI5dDhgzxHOSOOuoo9LSgW/hHSSyUCm3efPNNt7QnRIlPmjBhAq7DEySBmSIjRkAtNszRIdY6kdzy/Nprr+ncTD0jZ5tZEMprrrnmxBNPxG1MYOlH3EJBizlz5ugCLUAzSJq9MuMXX3xx0KBBFiTFc54mhtR32rRpUQvwWugQDaeE6ARXe+WNCaAFAYryWpMrem6hB/S5hX01aYBKqoWZGRPH0EC11fdqaMScfvrps2fP9iOq0e1Q3H/lrs2bN4tU5Cn6TiSANbTkgyHgBUSwSoUoBOk06P6RuygptwiT4KaBMM58FLzCkGWVI44RIbnGGb+MGTOG1Ihi/PjxkyZNyrgNtPbt27/33ntkDJh+VRszNVBwwR9hIWTu4Jm7w3NXZqyNdAl4O3ToIFvhgYdWiDxKbXqglF98oqPm4wPn8sZCMsSQliVIZTsod0UPUixsxROTEFr6xC9wzRsLG1rQHzFixLjcJWYliAnuOcR0Fx/tC1p0jPmeTclOnTrpJw8Zq0Sjb9++YhanJzQtnFRFFbQt/9Ye5oCwZqUyE2RrY6gyFpu9kSmOOIJ66623zHfPKIEoMA8F1qxZkxkTdC2p9YUqn1ApDcDY2qHhrrvuAor+49n04tNGGT01PXq55zm7xojRXvIPbtuacwtciG5zEQZ7pZhmPpXBcyAgRoGWhMFpSiGZDrMFY23jAbARk8wYBibb2Wefffzxx5tyTlrVq1dXfEDKFm2UGhaaVP0QMeYzImXGtiERcsahOGnF6ADkntzl6KG3hO1Hx4oQbR2RopgAi9OVJ0DKPwPAgEd4+lkncCB+ii0ppM6OUgxwUzJ6FapnnHGGOosKmQWGT++8845+kjOFJHIETxc0aNCAWmXGpvYpp5ziNmJYF0t/AElAZcEntdOMclELhEX1FE9I220NFDiLdl/uil3AYQsMDdGNecYwxW2dhIY4SKiKPRcvNLyGkRTd/Pvd/LhRJPUk3RoVngCXqunrOV+VSnlVFIXiFpgIU2aM8TETzSTtCQmHEDNZVfGEtwiHPYaPHj1aC+lnn/kpqVqA3Z+7YjIWD0252SIOXrDwJM77zIeNpbyZG82bN0cjPn01zTCMDaic+vQctsMMLlpSOaGbQqJlBefGjRtTKQwx+tCoUaNGSiJnQOgZ7SVBPh577DGnVAfdzBhdbOxLJMM5V/QgDkSc80M31Rn5ONeP5oGRlK+zGEANDNIrPE7ETDQDEWIMYQYSFCD8lE3D51tStryRxYhNIKZHnKujHM4BY3MXOriLiyZEHm3n5dA3+qC3VFjaVCnuSoSw6g1TTVHxTFJok/fstQGGYjZrhMDszDPPjIOKanFoetndvrjoEwWyQRdElR5X2kgy/NAGeztgh+fQc1noEJkzBhANTDFEVU+7Be8RwD0tqcMdPHQrSQYySkYg6idnRU2IHSdNoaoT0WUgBSgYjhii6UFtCz7AJkZ6oLcz6VWelBKcjzvuuMMPP7xkyZKVK1cuVapU2bJlnV2QQT0pBNpRtZo1a1arVs1BtVy5cueee25CV7LAvkSJErKiCuxjI2OIZ5LKmIFuwTkLu3ve62gKTYPkEUccwWH58uUdpSpWrOi2DqPqwsYwmzpTn3TSSerifO0xIpvOP/98+2FVpUqV3BbMCSec4J6vqG4YoI0+Oe2001jWrVtXCatUqVK1alXnjqSqxxxzDLeHHXaYyDl0DnKCrFGjhhMA8BwIvYEIEgsdl2TuTdMLNv5mYUM45S5RyL9ChQrwOPTQQzHUXW3AiZEgYLGwEYIJ5XyRGV9++eUsIRRIaKCOuSsYIiMgy4W9s5a9DA3t5U0n4QaDgw46qEyZMj6tEUBuIsdKDJWOWz6dDAWvmcTMM8Imv8KDuNWuXbty7ipdunTF/1wDcxe5RjKCAX+iLwSRiyIVi3M09t7cFesYV0X//8qLATJqCV2OhiilV8mIZiB6hpajGBnAFq2K/xRK5nnAEEuLSZ4ZJdJb0IKq7mPsEOR3FdFbsmNmTdWy8zZjJwAAaMM4L0Bbko519o6TAYUUC582MisRXqtYZMaeJgNu001nEqc5L98W/JNoNt4x1Aa8drGWIORAmD/1or7qhT4A01uAr84EuM2DntODMWvprvwd1GyU4oAvHv5lJWFyr2P1tj53F0hsGOtkCVpwRjzyr/2MUc/IpgHKCGTKru/1jbnLWM9LysEN290l4KQG81IQkFvx+JXEgF0zCCzOYc4UHIrZM3bk0ANaTVKZsexpCpUyNMCuDJCzV/x7ye+M4c8/VaPboVZyydTTIUbrOZeFK1/jvcbp2O8I5xlnH+viN8r8ySDGMgDjX2pqCw+UsjDu3aUHCot83gt9UlwoEEwnkcSA0OkVAcsTEoYGe6yKwxUBj39biR8XY3e31C/7bwWJtg1jBVAtryAqB9gwhpDKBTfxxEEB7d0FfuaZyiCJjgODmQBVxXSCCGNnMuDZwiTxAMIDz2MeSF67mZFYRRahwggBT4QaxvrZcAO4OsVRGM6C1wXJQEIGBVA99zCMZxFCQZ762QwDp7URJVobcWDrzLOTMt2joTJn7JguZrnheWFhoTqJy6AhSSLHZ2PYFtoDC5POxo04O8gKnqTXRjYmYCqvsR2wVcEA0WrQEgK0pJbsZ7V9+3bGSqXm8V+t+NeZTXnAB/wXTvyrAWEEn4UtZ2TwUoKhKsQPGjl48eYcHO/cHrBmY23rYJiM8scK8wVIRIP0mnKmEX2M/zPZCyLopbGx3dzAfIhkum0+K5oRF53E2FigzA0bNhQnz4p85JFHAk+cLM0qQ48qCzOZbLSexBtfHrKoVasWDTcrLXQiYRELeS0oKDASSZ3XAqHBKMUbkSANXp/GgjnmaWDCSSehFIeoQrSE48SmFlHRzDjrzJTsSvfEzNUhhxzCIODQQORFbXFTLIgsKVzK/7ciO46lJBJuDTT+Dz74YMwJYycTFVYwbo1lOZtkei5/6g3jermLvT5hXOwZzoY+PWV59NFHi1+riCVvHGGTa6cWvxJN89lADGPvZbLQMzqBYhvaHGBh3pjuuR3/CVMPyZupuiWMxSXUOJ3jEj2XtoLL+d8IvevNIoh7wgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"decoded_char\"\n        title=\"decoded_char\"\n        src=\"/if-blog-react/static/a38f3e2fe26a446a0d5fd3f5d539387b/c5296/decoded_char.png\"\n        srcset=\"/if-blog-react/static/a38f3e2fe26a446a0d5fd3f5d539387b/c5296/decoded_char.png 64w\"\n        sizes=\"(max-width: 64px) 100vw, 64px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>左が教師データ、右がdecodeされた文字となる。auto-encoderなのでぼやけているのはしょうがないが割と綺麗にデコードできている。ただし、画数の多い文字となるとやはりぼやけて元の文字がわからない。この辺は、モデルや学習のパラメタを調整することでも少し改善されると思う。  </p>\n<p>生成された特徴量も確認しておく。<br>\n以下に、'寂', ',', 'ッ', '鏡', '奸', 'Ｐ', '跳', '・', '“', 'ょ'の記号を含む10文字を与えた際の特徴量を図示する。\n特徴量は、1文字あたり(4,4,8)次元となるので、4×4の画像を8枚横に並べたものを表示している。  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/8ff1e/hidden_dim.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACF0lEQVQ4y62UW0syYRSF++HRlYQgeRGE5jk1z5qn0jxmHkoNUS/UG/E/BBke9/c9G0YYvG1geGf7zrv2Wmuv8UL+X8fjUf7iAufCABuPx5JOp6XRaMhyuZRerycPDw9Sq9VksVjIy8uLRCIRrVerlRQKBUkkEvL29ibT6VS2263inAA7nY5YrVZ5fHzUF51Op1xdXUkgEBCv16s1+263W2+bzSY3NzcSj8fF5XLJ7++vGZAuHK5WqxIKhSQYDIrf75fX11ddaRSLxeT5+VlrmlBDxOFwyHq9NgN+fX3J/f29VCoVKRaLusIEiZlMRpt5PB5tUK/XFYx9LKLBz8+PGfDj40MPANDv96VUKqkswHjmMA0BwjekogTfm82mHA4HM+BsNlNWk8lEb4YSDof1+fPzU56enpQ5EqkZSj6fV2WtVks2m40ZEFawoHu5XFZWhoewYOKwyuVyJ7nYAAnqs6EMh0M1Gsm8hE8AAGwcSqVSWuNbNpvVfYYIid1uZwZ8f3/XaMCATDJNYoKHSLy7u9Ma0Pl8risMaTQYDM4lt9ttlUhHVvzBQ+SzRw0jmOMrTAk7+9i13+/PY2MA8kWQO/JlAGEHLKPRqKaBPRiigGCf5ZBJ2e12BfD5fCrl9vZWpSWTSQWxWCwKwu/X19daE53Ly0v5/v42A45Go1Nw6UpEWGnU7XbVR/zFa25iYwwF0NOU//rf5h/8PObLKYAstwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hidden_dim\"\n        title=\"hidden_dim\"\n        src=\"/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/c7805/hidden_dim.png\"\n        srcset=\"/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/c0399/hidden_dim.png 100w,\n/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/9ec3c/hidden_dim.png 200w,\n/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/c7805/hidden_dim.png 400w,\n/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/34e8a/hidden_dim.png 600w,\n/if-blog-react/static/e2e2554113b2031d6754fe63abd5c0c4/8ff1e/hidden_dim.png 800w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>図をみると、文字ごとの偏りはなく学習できているように見える。</p>\n<p>lossは0.04とある程度小さい値となったが、accは0.6とそこまで高い値とはならなかった。改善のため何をすれば良いかの指標がいまいちわからん。損失関数と最適化関数は良さそうなので、とりあえず、層の数やunit数、学習率などのパラメタや教師データを増やすなど試してみようと思う。随時更新していく。</p>","id":"7fde1f40-b36c-59a9-9653-90a42e3c2f74","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/nlp/char_vec/#%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8B%E3%82%89%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%82%92%E7%94%9F%E6%88%90\">フォントファイルからフォント画像を生成</a></li>\n<li><a href=\"/if-blog-react/nlp/char_vec/#%E6%96%87%E5%AD%97%E5%88%97%E3%81%A8%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%82%92%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0\">文字列とフォント画像をマッピング</a></li>\n<li>\n<p><a href=\"/if-blog-react/nlp/char_vec/#%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E7%94%BB%E5%83%8F%E3%81%8B%E3%82%89%E7%89%B9%E5%BE%B4%E9%87%8F%E3%82%92%E7%94%9F%E6%88%90\">フォント画像から特徴量を生成</a></p>\n<ul>\n<li><a href=\"/if-blog-react/nlp/char_vec/#%E5%AD%A6%E7%BF%92\">学習</a></li>\n<li><a href=\"/if-blog-react/nlp/char_vec/#%E7%B5%90%E6%9E%9C\">結果</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"文字をベクトル化する","date":"2019-09-23","tags":["nlp","deeplearning","python"]},"fields":{"slug":"/nlp/char_vec/"}}},{"node":{"excerpt":"word2vecで単語をベクトルにしたり、類似度判定した記事はたくさんあるが、ベクトルから類似単語を出力する日本語記事を見つけられなかったのでメモ。\nstack overflowにあった。\nhttps://stackoverflow.com/questions/32759712/how-to-find-the-closest-word-to-a-vector-using-word2vec…","html":"<p>word2vecで単語をベクトルにしたり、類似度判定した記事はたくさんあるが、ベクトルから類似単語を出力する日本語記事を見つけられなかったのでメモ。\nstack overflowにあった。\n<a href=\"https://stackoverflow.com/questions/32759712/how-to-find-the-closest-word-to-a-vector-using-word2vec\">https://stackoverflow.com/questions/32759712/how-to-find-the-closest-word-to-a-vector-using-word2vec</a></p>\n<h2 id=\"結論\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p>結論から言うと、以下のように適当にモデルを作りmost_simlar関数にベクトルを与えるだけ。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">sentences <span class=\"token operator\">=</span> gensim<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>word2vec<span class=\"token punctuation\">.</span>Text8Corpus<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\nmodel <span class=\"token operator\">=</span> Word2Vec<span class=\"token punctuation\">(</span>sentences<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> window<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> min_count<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> workers<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>most_similar<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">[</span> vector <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>ただし、第3引数は出力する類似単語数を表す。</p>\n<h2 id=\"使用例\"><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\" aria-label=\"使用例 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用例</h2>\n<p><a href=\"http://www.aozora.gr.jp/index_pages/person1779.html\">青空文庫：江戸川乱歩</a>の解析をしたので、その例を示す。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>wv<span class=\"token punctuation\">[</span><span class=\"token string\">\"ベクトル化したい単語\"</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>で単語をベクトル化できる。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">sentences <span class=\"token operator\">=</span> gensim<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>word2vec<span class=\"token punctuation\">.</span>Text8Corpus<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\nmodel <span class=\"token operator\">=</span> Word2Vec<span class=\"token punctuation\">(</span>sentences<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> window<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> min_count<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> workers<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nvector <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>wv<span class=\"token punctuation\">[</span><span class=\"token string\">\"犯罪\"</span><span class=\"token punctuation\">]</span>\nword <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>most_similar<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">[</span> vector <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>vector<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上記のようなコードを実行すると、</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>-0.01494294 -0.1509463   <span class=\"token number\">0.06123272</span> <span class=\"token punctuation\">..</span>.,  <span class=\"token number\">0.01335443</span>  <span class=\"token number\">0.03439184</span>\n  <span class=\"token number\">0.05130962</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'犯罪'</span>, <span class=\"token number\">1.0000001192092896</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>となり、「犯罪」をベクトル化し、そのベクトルから単語が出力できている。</p>\n<h3 id=\"出力数を変更\"><a href=\"#%E5%87%BA%E5%8A%9B%E6%95%B0%E3%82%92%E5%A4%89%E6%9B%B4\" aria-label=\"出力数を変更 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>出力数を変更</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">vector <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>wv<span class=\"token punctuation\">[</span><span class=\"token string\">\"明智\"</span><span class=\"token punctuation\">]</span>\nword <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>most_similar<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">[</span> vector <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>以下のような結果が得られる。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'明智'</span>, <span class=\"token number\">1.0000001192092896</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'名'</span>, <span class=\"token number\">0.8110731840133667</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'博士'</span>,　<span class=\"token number\">0.8006758093833923</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'氏'</span>, <span class=\"token number\">0.7667115330696106</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'殿村'</span>, <span class=\"token number\">0.7487545609474182</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3 id=\"単語のみを出力\"><a href=\"#%E5%8D%98%E8%AA%9E%E3%81%AE%E3%81%BF%E3%82%92%E5%87%BA%E5%8A%9B\" aria-label=\"単語のみを出力 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>単語のみを出力</h3>\n<p>単語のみを出力するために、以下のようにしておくとよい</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>most_similar<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">[</span> vector <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3 id=\"任意のベクトル入力\"><a href=\"#%E4%BB%BB%E6%84%8F%E3%81%AE%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E5%85%A5%E5%8A%9B\" aria-label=\"任意のベクトル入力 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>任意のベクトル入力</h3>\n<p>以下のようにして、任意のベクトルができる。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\">vec <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\nvec<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nvec <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>vec<span class=\"token punctuation\">,</span>dtype<span class=\"token operator\">=</span><span class=\"token string\">'f'</span><span class=\"token punctuation\">)</span>\nword <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>most_similar<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">[</span> vector <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>出力結果</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'点い'</span>, <span class=\"token number\">0.04825586825609207</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'ワハハハハハハハハ'</span>, <span class=\"token number\">0.04788881167769432</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'珍奇'</span>, <span class=\"token number\">0.04669386148452759</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'憎らしい'</span>, <span class=\"token number\">0.04500409588217735</span><span class=\"token punctuation\">)</span>, <span class=\"token punctuation\">(</span><span class=\"token string\">'な'</span>, <span class=\"token number\">0.04486800357699394</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p><code class=\"language-text\">most_similar</code>使えばいける。ちなみに公式には、<code class=\"language-text\">model.wv.most_similar</code>って書いてあったけど、wvなくてもできた。公式には、ベクトルは、<code class=\"language-text\">model.wv</code>のKeyedVectorsインスタンスに保存されてるって書いてあったけどよくわかってない。\n今回は総単語数19002だったのだが、実行時間は1分ほど。word2vec高速すごい。</p>","id":"6ad8f836-90e9-5146-a6c2-32c1bc290a2c","tableOfContents":"<ul>\n<li><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E7%B5%90%E8%AB%96\">結論</a></li>\n<li>\n<p><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E4%BD%BF%E7%94%A8%E4%BE%8B\">使用例</a></p>\n<ul>\n<li><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E5%87%BA%E5%8A%9B%E6%95%B0%E3%82%92%E5%A4%89%E6%9B%B4\">出力数を変更</a></li>\n<li><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E5%8D%98%E8%AA%9E%E3%81%AE%E3%81%BF%E3%82%92%E5%87%BA%E5%8A%9B\">単語のみを出力</a></li>\n<li><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E4%BB%BB%E6%84%8F%E3%81%AE%E3%83%99%E3%82%AF%E3%83%88%E3%83%AB%E5%85%A5%E5%8A%9B\">任意のベクトル入力</a></li>\n</ul>\n</li>\n<li><a href=\"/if-blog-react/nlp/word2vec_output_word/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>","frontmatter":{"title":"word2vecでベクトルから単語を出力する","date":"2019-09-23","tags":["python","word2vec"]},"fields":{"slug":"/nlp/word2vec_output_word/"}}},{"node":{"excerpt":"pyenv環境でaws cli入れたらコマンドが見つからないって言われたので調べたメモ バージョン： 公式通りにインストールする。 すると、 コマンドが見つからない.... 調べると、にインストールされるらしいので、パスを通す。 できた！ pyenvが問題なのかはわからん....","html":"<p>pyenv環境でaws cli入れたらコマンドが見つからないって言われたので調べたメモ</p>\n<p>バージョン：<code class=\"language-text\">pyenv:1.0.10</code></p>\n<p>公式通りにインストールする。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ pip3 install awscli --upgrade --user</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>すると、</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ aws\n-bash: aws: command not found</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>コマンドが見つからない....</p>\n<p>調べると、<code class=\"language-text\">$HOME/.local</code>にインストールされるらしいので、パスを通す。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">aws --version\naws-cli/1.16.29 Python/2.7.13 Darwin/16.7.0 botocore/1.12.19</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>できた！</p>\n<p>pyenvが問題なのかはわからん....</p>","id":"0745e12f-1340-5940-908d-fb78daad02b4","tableOfContents":"","frontmatter":{"title":"pyenv環境でaws cli入れたらコマンドが見つからない","date":"2019-09-23","tags":["python","aws"]},"fields":{"slug":"/others/aws-cli-at-pyenv/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":true}}}